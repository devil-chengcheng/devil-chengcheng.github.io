<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="小二、上酒" type="application/atom+xml">






<meta name="description" content="人生当苦无妨，良人当归即好">
<meta property="og:type" content="website">
<meta property="og:title" content="小二、上酒">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="小二、上酒">
<meta property="og:description" content="人生当苦无妨，良人当归即好">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小二、上酒">
<meta name="twitter:description" content="人生当苦无妨，良人当归即好">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/6/">





  <title>小二、上酒</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小二、上酒</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/web全栈/nodejs相关笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/web全栈/nodejs相关笔记/" itemprop="url">nodejs相关笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web全栈/" itemprop="url" rel="index">
                    <span itemprop="name">web全栈</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="nodejs相关笔记"><a href="#nodejs相关笔记" class="headerlink" title="nodejs相关笔记"></a>nodejs相关笔记</h2><p>NodeJS和其他后台语言不同：<br>优点：</p>
<ol>
<li>nodejs的对象、语法和JavaScript一模一样，利于前端人员使用。</li>
<li>性能还可以</li>
<li>前后台配合方便</li>
</ol>
<p>缺点：</p>
<ol>
<li>Java有极其丰富的库支持，这是nodejs比不上的。</li>
</ol>
<p>Nodejs用处：</p>
<ol>
<li>服务器————小型后台系统，中间层</li>
<li>工具：测试、构建（grunt、gulp、webpack…）、抓取</li>
</ol>
<hr>
<p>运行nodejs文件：</p>
<ol>
<li>盘符：d：、c:、e:…</li>
<li>进入目录： cd 目录</li>
<li>运行：node 文件名</li>
</ol>
<hr>
<p>总结：  </p>
<ol>
<li><p>nodejs和javascript差不多</p>
</li>
<li><p>nodejs严重依赖模块运行</p>
</li>
<li><p>http模块：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 有浏览器请求时执行的回调函数</span></span><br><span class="line">&#125;);</span><br><span class="line">serverlisten();</span><br></pre></td></tr></table></figure>
</li>
<li><p>nodejs和js一样是单线程、单进程。非阻塞异步交互，性能上接近多线程  </p>
</li>
</ol>
<h3 id="nodejs模块"><a href="#nodejs模块" class="headerlink" title="nodejs模块"></a>nodejs模块</h3><h4 id="1-http模块"><a href="#1-http模块" class="headerlink" title="1. http模块"></a>1. http模块</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> serve = http.createServer(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// request:接收的数据（输入）</span></span><br><span class="line">  <span class="comment">// response：发送的数据（输出）</span></span><br><span class="line"></span><br><span class="line">  response.write(<span class="string">'aaa'</span>);</span><br><span class="line">  response.end();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'有人执行'</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 监听</span></span><br><span class="line">serve.listen(<span class="number">8082</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2-assert断言"><a href="#2-assert断言" class="headerlink" title="2. assert断言"></a>2. assert断言</h4><p>第一个参数为条件，第二个参数为条件不成立时提示</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">'assert'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    assert(<span class="built_in">arguments</span>.length == <span class="number">2</span>, <span class="string">'必须传两个参数'</span>);</span><br><span class="line">    assert(<span class="keyword">typeof</span> a == <span class="string">'number'</span>, <span class="string">'第一个参数必须是数字'</span>);</span><br><span class="line">    assert(<span class="keyword">typeof</span> b == <span class="string">'number'</span>, <span class="string">'第二个参数必须是数字'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum(<span class="number">12</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h4 id="3-Buffer二进制和FileSystem"><a href="#3-Buffer二进制和FileSystem" class="headerlink" title="3. Buffer二进制和FileSystem"></a>3. Buffer二进制和FileSystem</h4><p>对于服务器来说，基本都是异步的操作。<br>FileSystem帮助读写文件。readFile、writeFile<br>用Buffer对象处理二进制数据，二进制数据不要转成字符串，否则图片等文件会损毁</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="comment">// 读文件readFile</span></span><br><span class="line">fs.readFile(<span class="string">'1.txt'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'error'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写文件writeFile</span></span><br><span class="line">fs.writeFile(<span class="string">'2.txt'</span>, <span class="string">'asfdsagf'</span>, err =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'success'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="4-C-Addons"><a href="#4-C-Addons" class="headerlink" title="4. C++ Addons"></a>4. C++ Addons</h4><p>用C语言写插件给modejs用</p>
<h4 id="5-多进程"><a href="#5-多进程" class="headerlink" title="5. 多进程"></a>5. 多进程</h4><p>Child Processes、Cluster、Process配合</p>
<h4 id="6-Crypto签名"><a href="#6-Crypto签名" class="headerlink" title="6. Crypto签名"></a>6. Crypto签名</h4><p>帮助nodejs加密。 md5、sha</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">let</span> obj = crypto.createHash(<span class="string">'md5'</span>);<span class="comment">// md5,sha1</span></span><br><span class="line"><span class="comment">// obj.update('123456');</span></span><br><span class="line">obj.update(<span class="string">'123'</span>);</span><br><span class="line">obj.update(<span class="string">'456'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj.digest(<span class="string">'hex'</span>));</span><br></pre></td></tr></table></figure>

<h4 id="7-OS"><a href="#7-OS" class="headerlink" title="7. OS"></a>7. OS</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(os.cups());</span><br></pre></td></tr></table></figure>

<h4 id="8-Path"><a href="#8-Path" class="headerlink" title="8. Path"></a>8. Path</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">path.parse();</span><br><span class="line"><span class="keyword">let</span> str = <span class="string">'/local/www/aaa/1.png'</span>;</span><br><span class="line"><span class="comment">// dirname  /local/www/aaa</span></span><br><span class="line"><span class="comment">// basename  1.png</span></span><br><span class="line"><span class="comment">// extname  .png</span></span><br></pre></td></tr></table></figure>

<h4 id="9-Events事件队列"><a href="#9-Events事件队列" class="headerlink" title="9. Events事件队列"></a>9. Events事件队列</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Event = <span class="built_in">require</span>(<span class="string">'events'</span>).EventEmitter;</span><br><span class="line"><span class="keyword">let</span> ev = <span class="keyword">new</span> Event();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 监听（接收）</span></span><br><span class="line">ev.on(<span class="string">'msg'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'收到了msg事件：'</span>, a, b, c);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 派送（发送）</span></span><br><span class="line">ev.emit(<span class="string">'msg'</span>, <span class="number">34</span>, <span class="number">54</span>, <span class="number">55</span>)</span><br></pre></td></tr></table></figure>

<h4 id="10-Query-Strings查询字符串和URL"><a href="#10-Query-Strings查询字符串和URL" class="headerlink" title="10. Query Strings查询字符串和URL"></a>10. Query Strings查询字符串和URL</h4><p>Query Strings用来解析url问号后面</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对url？后面的参数进行解析</span></span><br><span class="line"><span class="keyword">let</span> obj = querystring.parse(<span class="string">'spm_id_from=333.851.b_7072696d61727950616765546162.3'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br></pre></td></tr></table></figure>

<p>而URL用来解析整个url</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = url.parse(<span class="string">'https://www.bilibili.com/ranking?spm_id_from=333.851.b_7072696d61727950616765546162.3'</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br></pre></td></tr></table></figure>

<h4 id="11-网络"><a href="#11-网络" class="headerlink" title="11. 网络"></a>11. 网络</h4><ul>
<li>TCP：稳定 Net</li>
<li>UDP：快 UDP/Datagram</li>
</ul>
<h4 id="12-域名解析"><a href="#12-域名解析" class="headerlink" title="12. 域名解析"></a>12. 域名解析</h4><ul>
<li>DNS</li>
<li>Domain<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dns = <span class="built_in">require</span>(<span class="string">'dns'</span>);</span><br><span class="line"></span><br><span class="line">dns.resolve(<span class="string">'baidu.com'</span>, (err, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'解析失败'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="13-流操作——Stream"><a href="#13-流操作——Stream" class="headerlink" title="13. 流操作——Stream"></a>13. 流操作——Stream</h4><p>连续数据都是流——视频流、网络流、文件流、语音流</p>
<h4 id="14-TLS-SSL"><a href="#14-TLS-SSL" class="headerlink" title="14. TLS/SSL"></a>14. TLS/SSL</h4><p>加密、安全</p>
<h4 id="15-ZLIB–gz"><a href="#15-ZLIB–gz" class="headerlink" title="15. ZLIB–gz"></a>15. ZLIB–gz</h4><p>压缩</p>
<h3 id="Nodejs数据交互"><a href="#Nodejs数据交互" class="headerlink" title="Nodejs数据交互"></a>Nodejs数据交互</h3><p>nodejs创建服务</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> serve = http.createServer(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// request:接收的数据（输入）</span></span><br><span class="line">  <span class="comment">// response：发送的数据（输出）</span></span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">`www<span class="subst">$&#123;request.url&#125;</span>`</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">      response.writeHeader(<span class="number">404</span>); <span class="comment">// header</span></span><br><span class="line">      response.write(<span class="string">'Not Found'</span>); <span class="comment">// body</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      response.write(data);</span><br><span class="line">    &#125;</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 监听</span></span><br><span class="line">serve.listen(<span class="number">8082</span>);</span><br></pre></td></tr></table></figure>

<p>web服务器：</p>
<ol>
<li>返回文件</li>
<li>数据交互（GET、POST）</li>
<li>数据库</li>
</ol>
<h4 id="get数据获取"><a href="#get数据获取" class="headerlink" title="get数据获取"></a>get数据获取</h4><p>客户端get表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost:8080/aaa"</span> <span class="attr">method</span>=<span class="string">"GET"</span>&gt;</span></span><br><span class="line">  用户:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pass"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>后端nodejs处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = http.createServer(<span class="function">(<span class="params">request, response</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// console.log(request.url);</span></span><br><span class="line">    <span class="keyword">let</span> obj = url.parse(request.url, <span class="literal">true</span>); <span class="comment">// pathname,query</span></span><br><span class="line">    response.end();</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>

<h4 id="post数据获取"><a href="#post数据获取" class="headerlink" title="post数据获取"></a>post数据获取</h4><p>post数据比较大，分多次传送。一个大数据包切成一堆小包：可以方便所有人，容错强的多。</p>
<ul>
<li>url.parse() 对整个url解析</li>
<li>querystring.parse() 仅仅对数据部分进行解析<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = http.createServer(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">''</span>;</span><br><span class="line">    <span class="comment">// 有一段数据到达了</span></span><br><span class="line">    request.on(<span class="string">'data'</span>, data =&gt; &#123;</span><br><span class="line">        str += data;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 结束了</span></span><br><span class="line">    request.on(<span class="string">'end'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> post = querystring.parse(str);</span><br><span class="line">        <span class="built_in">console</span>.log(post);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    response.end();</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8080</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><ol>
<li>关系型数据库：MySQL、Oracle  最常见、最常用。数据之间是由关系的。</li>
<li>文件型数据库：sqlite  简单、小</li>
<li>文档型数据库：MongoDB  直接存储异构数据、方便</li>
</ol>
<ul>
<li>MySQL 80% 免费、绝大多数普通应用。性能高、安全性高，容灾略差</li>
<li>Oracle 收费 金融、医疗。容灾特别强。</li>
</ul>
<h3 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h3><ol>
<li>express：回调。入门简单，做东西极其麻烦</li>
<li>koa：async、await。入门麻烦、做东西舒服</li>
</ol>
<h4 id="express结构"><a href="#express结构" class="headerlink" title="express结构"></a>express结构</h4><p>express是一种非破坏式框架。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">res.send(any);</span><br><span class="line">res.sendFile(绝对路径文件名)  跟<span class="keyword">static</span>不一样，更灵活</span><br><span class="line">res.sendStatus(code)  相当于writeHeader + write + end</span><br><span class="line">res.redirect(<span class="string">'location'</span>)</span><br></pre></td></tr></table></figure>

<h5 id="数据交互：GET、POST"><a href="#数据交互：GET、POST" class="headerlink" title="数据交互：GET、POST"></a>数据交互：GET、POST</h5><ul>
<li><p>GET：req.query</p>
</li>
<li><p>普通POST：body-parser</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.user(body.urlencoded(&#123;extended: false&#125;))</span><br><span class="line">req.body</span><br></pre></td></tr></table></figure>
</li>
<li><p>文件POST: multer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const multer = requre(&apos;multer&apos;)</span><br><span class="line"></span><br><span class="line">server.use(multer(&#123;dest&#125;).any())</span><br><span class="line"></span><br><span class="line">req.body</span><br><span class="line">req.files</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="cookie、session"><a href="#cookie、session" class="headerlink" title="cookie、session"></a>cookie、session</h5><p>cookie：存在浏览器里，容量有限（4K），不安全<br>防篡改</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.use(cookieParser([secret],&#123;&#125;))</span><br><span class="line"></span><br><span class="line">req.cookies  <span class="comment">// 接收</span></span><br><span class="line">req.signedCookies  <span class="comment">//接收带签名的</span></span><br><span class="line">res.cookie(name, value, options)  <span class="comment">// 发送</span></span><br></pre></td></tr></table></figure>

<p>session：存在服务器，容量不用担心，安全<br>session劫持：即将sess_id拿走使用。<br>解决：session定期更换ID或带签名</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.use(cookieSession(&#123;</span><br><span class="line">    keys or secret</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">req.session</span><br></pre></td></tr></table></figure>

<h5 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h5><p>拆分，即是一个switch<br>定义：根据地址不同，调用不同的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">switch(url) &#123;</span><br><span class="line">    case &apos;XXX&apos;:</span><br><span class="line">        XXXX;  // 代码</span><br><span class="line">    case &apos;XXX&apos;:</span><br><span class="line">        XXXX;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>创建</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> router = express.Router()</span><br></pre></td></tr></table></figure>
</li>
<li><p>给路由填东西</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">'地址'</span>, () =&gt; &#123;&#125;)</span><br><span class="line">router.post(<span class="string">'地址'</span>, () =&gt; &#123;&#125;)</span><br><span class="line">router.use(<span class="string">'地址'</span>, () =&gt; &#123;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加到父级</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.use(<span class="string">'路径'</span>, router)</span><br><span class="line">parentRouter.use(<span class="string">'路径'</span>, router)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>例子：<br>主文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = express()</span><br><span class="line">server.listen(<span class="string">'8089'</span>)</span><br><span class="line"></span><br><span class="line">server.use(<span class="string">'/article'</span>, <span class="built_in">require</span>(<span class="string">'./routes/article'</span>))</span><br><span class="line">server.use(<span class="string">'/user'</span>,<span class="built_in">require</span>(<span class="string">'./routes/user'</span>))</span><br><span class="line"></span><br><span class="line">server.use(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.send(<span class="number">404</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>article路由:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> router = express.Router()</span><br><span class="line">router.get(<span class="string">''</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'文章首页'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/:id'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'文章内容'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/:id/comment'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'文章评论'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/:id/edit'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'编辑文章'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.use(<span class="string">'/aaa'</span>, <span class="built_in">require</span>(<span class="string">'./aaa'</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>

<p>article中aaa分路由：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> router = express.Router()</span><br><span class="line">router.get(<span class="string">'/a'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'a'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/b'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'b'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/c'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'c'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>

<p>user路由：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> router = express.Router()</span><br><span class="line">router.get(<span class="string">'/:id'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'用户信息'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.get(<span class="string">'/:id/comment'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send(<span class="string">'用户发的评论'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>

<h5 id="服务器渲染"><a href="#服务器渲染" class="headerlink" title="服务器渲染"></a>服务器渲染</h5><p>后端渲染（组装）：根据数据和模板html生成出来；<br>前端渲染（组装）：将html生成出来<br>浏览器渲染：输入url -&gt; 加载 -&gt; html、css、js、img… -&gt; 渲染（画出来）</p>
<p>后端渲染 VS 前端渲染<br>后端渲染的优点是稳定、安全、利于SEO<br>前端渲染的优点在于体积更小、灵活、体验好</p>
<p>服务器渲染：</p>
<ul>
<li>pug：破坏式——破坏HTML</li>
<li>ejs：非破坏式——保留HTML结构</li>
</ul>
<p>pug.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pug = <span class="built_in">require</span>(<span class="string">'pug'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(pug.renderFile(<span class="string">'./template/pug/1.pug'</span>, &#123;</span><br><span class="line">  pretty: <span class="literal">true</span>,</span><br><span class="line">  name: <span class="string">'blue'</span>,</span><br><span class="line">  a: <span class="number">12</span>,</span><br><span class="line">  b: <span class="number">5</span>,</span><br><span class="line">  arr: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>

<p>1.pug</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    meta(charset=&quot;utf-8&quot;)</span><br><span class="line">    link(rel=&quot;stylesheet&quot;,href=&quot;/css/main.css&quot;)</span><br><span class="line">    script(src=&quot;main.js&quot;)</span><br><span class="line">  body</span><br><span class="line">    div(class=&quot;page main&quot;)#div1</span><br><span class="line">      ul.list</span><br><span class="line">        each a in arr</span><br><span class="line">          li = a</span><br><span class="line">        //- li dagjksf</span><br><span class="line">        //- li dsafl;sk</span><br><span class="line">        //- li dsfjakf</span><br><span class="line"></span><br><span class="line">      p.</span><br><span class="line">        kjdsfajks</span><br><span class="line">        sdfakjfkj</span><br><span class="line">        sjfkasdfhj</span><br><span class="line">        aslkfkskf</span><br><span class="line"></span><br><span class="line">      span 用户名:</span><br><span class="line">        = name</span><br><span class="line">        = a+b</span><br></pre></td></tr></table></figure>

<p>ejs  </p>
<ol>
<li>输出<ul>
<li>转义输出  &lt;%= %&gt;</li>
<li>非转义输出  &lt;%- %&gt;</li>
</ul>
</li>
</ol>
<p>ejs主文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">'ejs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(ejs.renderFile('./template/ejs/1.html', &#123;&#125;))</span></span><br><span class="line"></span><br><span class="line">ejs.renderFile(<span class="string">'./template/ejs/2.html'</span>, &#123;</span><br><span class="line">  a: <span class="number">12</span>, <span class="attr">b</span>: <span class="number">5</span>,</span><br><span class="line">  str: <span class="string">'dksjfa'</span>,</span><br><span class="line">  arr: [<span class="number">12</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>]</span><br><span class="line">&#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;, err =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'渲染错误'</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>引用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    &lt;% for(let i=0;i&lt;arr.length;i++)&#123; %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">%=arr[i]%</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h5><p>所有语言（除JS之外）都有模块系统</p>
<ol>
<li>前端<ul>
<li>传统：requireJS——AMD，seaJS——CMD<br>  CMD：公共模块定义<br>  AMD：异步模块定义</li>
<li>现代：vue、angular、react</li>
</ul>
</li>
<li>后端<br> Node模块系统</li>
</ol>
<h4 id="KOA框架"><a href="#KOA框架" class="headerlink" title="KOA框架"></a>KOA框架</h4><p>koa和express区别：  </p>
<ul>
<li>express：非破坏式，不依赖router</li>
<li>koa：破坏式，依赖router</li>
</ul>
<p>express：<br>    server.get(‘/‘, function(req, res, next) =&gt; {})</p>
<p>koa3:<br>    server.use(async (ctx, next) =&gt; {})</p>
<p>方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(req, res, next)</span><br><span class="line">(ctx, next)</span><br><span class="line"></span><br><span class="line">ctx.request</span><br><span class="line">    ctx.request.method</span><br><span class="line">    ctx.request.url</span><br><span class="line">    ctx.request.header/headers</span><br><span class="line">    </span><br><span class="line">ctx.response</span><br><span class="line">    ctx.response.status = XXX    状态码</span><br><span class="line">    ctx.response.body = XXX      返回内容</span><br></pre></td></tr></table></figure>

<p>koa强依赖router</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r1 = router()</span><br><span class="line">server.use(r1.routes())</span><br><span class="line"></span><br><span class="line">r1.get(<span class="string">'XXX'</span>, <span class="keyword">async</span>)</span><br><span class="line">r1.post(<span class="string">'XXX'</span>, <span class="keyword">async</span>)</span><br><span class="line">r1.use(<span class="string">'XXX'</span>, <span class="keyword">async</span>)</span><br><span class="line">r1.put(<span class="string">'XXX'</span>, <span class="keyword">async</span>)</span><br><span class="line">r1.delete(<span class="string">'XXX'</span>, <span class="keyword">async</span>)</span><br></pre></td></tr></table></figure>



<p>例子：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = <span class="keyword">new</span> koa()</span><br><span class="line">server.listen(<span class="number">8089</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r1 = router()</span><br><span class="line">server.use(r1.routes())</span><br><span class="line"></span><br><span class="line">r1.get(<span class="string">'/aaa'</span>, <span class="keyword">async</span>(ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(ctx)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ctx.req      原生req对象</span></span><br><span class="line">  <span class="comment">// ctx.request  封装req对象</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ctx.res      原生res对象</span></span><br><span class="line">  <span class="comment">// ctx.response 封装res对象</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ctx.set('a', 12) // 向响应头中添加</span></span><br><span class="line">  <span class="comment">// ctx.response.body = 'abc'</span></span><br><span class="line">  <span class="comment">// ctx.response.status = 403</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(ctx.request.headers)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="静态资源"><a href="#静态资源" class="headerlink" title="静态资源"></a>静态资源</h5><p>koa-static无法进行压缩，必须是gz文件，所以一般不使用。koa-static-cache自动进行压缩和缓存<br>server.use(staticCache(‘路径’))</p>
<h5 id="请求数据"><a href="#请求数据" class="headerlink" title="请求数据"></a>请求数据</h5><ul>
<li>GET            ctx.request.query  <ul>
<li>路由参数   ctx.params  </li>
</ul>
</li>
<li>POST / 文件<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert将旧版中间件转换成新版中间件</span></span><br><span class="line">server.use(convert(better-body(&#123;</span><br><span class="line">    uploadDir: <span class="string">'路径'</span>,</span><br><span class="line">    keepExtensions: bool</span><br><span class="line">&#125;)))</span><br><span class="line"></span><br><span class="line">req.request.fields  <span class="comment">// 数据 + 文件信息</span></span><br><span class="line">req.request.files   <span class="comment">// 文件信息（全）</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h5><p>koa中cookie是自带的  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ctx.cookies.get(name)  </span><br><span class="line">ctx.cookie.set(name, value, options)  </span><br><span class="line">options:  </span><br><span class="line">  maxAge: 毫秒单位时间</span><br><span class="line">  expires：Data对象</span><br><span class="line">  path</span><br><span class="line">  domain</span><br></pre></td></tr></table></figure>

<h5 id="session"><a href="#session" class="headerlink" title="session"></a>session</h5><p>koa-session</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.use(session(&#123;&#125;, server))</span><br><span class="line"></span><br><span class="line">ctx.session</span><br></pre></td></tr></table></figure>

<h4 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h4>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/web全栈/nodejs文档笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/web全栈/nodejs文档笔记/" itemprop="url">nodejs文档笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web全栈/" itemprop="url" rel="index">
                    <span itemprop="name">web全栈</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="nodejs简介"><a href="#nodejs简介" class="headerlink" title="nodejs简介"></a>nodejs简介</h3><p>nodejs是一个开源和跨平台的JavaScript运行时环境，是一个可用于几乎任何项目的流行工具。</p>
<p>nodejs在浏览器外运行V8 JavaScript引擎。</p>
<p>nodejs应用程序运行于单个进程中，无需为每个请求创建新的线程。nodejs标准库中提供了一组异步的I/O原生功能（防止JavaScript代码被阻塞），并且nodejs中库通常是使用非阻塞的范式编写的（从而使阻塞行为成为例外而不是规范）</p>
<p>当nodejs执行I/O操作时（例如从网络读取、访问数据库或文件系统），nodejs会响应返回时恢复操作，而不是阻塞线程并浪费CPU循环等待。</p>
<p>这使 Node.js 可以在一台服务器上处理数千个并发连接，而无需引入管理线程并发的负担（这可能是重大 bug 的来源）。</p>
<p>nodejs具有独特的优势，因为为浏览器编写JavaScript的数百万前端开发者现在除了客户端代码之外还可以编写服务器端代码。</p>
<p>在 Node.js 中，可以毫无问题地使用新的 ECMAScript 标准，因为不必等待所有用户更新其浏览器，你可以通过更改 Node.js 版本来决定要使用的 ECMAScript 版本，并且还可以通过运行带有标志的 Node.js 来启用特定的实验中的特性</p>
<h4 id="大量的库"><a href="#大量的库" class="headerlink" title="大量的库"></a>大量的库</h4><p>npm 的简单结构有助于 Node.js 生态系统的激增</p>
<h4 id="nodejs与浏览器区别"><a href="#nodejs与浏览器区别" class="headerlink" title="nodejs与浏览器区别"></a>nodejs与浏览器区别</h4><ol>
<li>浏览器和nodejs==均使用JavaScript作为编程语言==</li>
<li>构建运行于浏览器的应用程序和构建nodejs应用程序完全不同</li>
<li>对于广泛使用JavaScript的前端开发者的角度来看，==nodejs巨大的优势：使用单一语言轻松编程所有一切，包括前端和后端==</li>
<li>在浏览器中，大多时候做的是与DOM或其他web平台API（例如cookies）进行交互。在==nodejs中是不存在的，没有浏览器提供的document、window、以及其他对象==</li>
<li>在浏览器中，不存在nodejs通过其模块提供的所有不错的API，例如文件系统访问功能</li>
<li>在 Node.js 中，可以控制运行环境。除非构建的是任何人都可以在任何地方部署的开源应用程序，否则你能知道会在哪个版本的Node.js上运行该应用程序。与浏览器环境（你无法选择访客会使用的浏览器）相比起来，这非常方便。</li>
<li>由于JavaScript发展速度非常快，但是浏览器发展的慢一些，且用户的升级速度也慢一些，因此有时在web上，不得不使用较旧的JavaScript/ECMAScript版本。可以==使用babel将代码转换为ES5兼容的代码，再交付给浏览器==，但在nodejs中，不需要这么做。</li>
<li>nodejs使用CommonJS模块系统，而在浏览器中，则还正在实现ES模块标准。</li>
<li>在实践中，这意味着在nodejs中使用require()，而在浏览器中则使用import</li>
</ol>
<h4 id="V8-JavaScript引擎"><a href="#V8-JavaScript引擎" class="headerlink" title="V8 JavaScript引擎"></a>V8 JavaScript引擎</h4><p>V8 是为 Google Chrome 提供支持的 JavaScript 引擎的名称。 当使用 Chrome 进行浏览时，它负责处理并执行 JavaScript。</p>
<p>V8提供了执行JavaScript的运行时环境。DOM和其他web平台API由浏览器提供。</p>
<p>==JavaScript 引擎独立于托管它的浏览器==。 此关键的特性推动了 Node.js 的兴起。 ==V8 于 2009 年被选为为 Node.js 提供支持的引擎==，并且随着 Node.js 的爆炸性发展，V8 成为了现在为大量的服务器端代码（使用 JavaScript 编写）提供支持的引擎。</p>
<h4 id="nodejs程序退出"><a href="#nodejs程序退出" class="headerlink" title="nodejs程序退出"></a>nodejs程序退出</h4><p>以编程的方式退出nodejs程序：process.exit()</p>
<p>默认情况下，退出码为0，表示成功。不同的退出码具有不同的含义，可以在系统中用于程序和其他程序的通信。</p>
<p>也可以设置process.exitCode属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.exitCode = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>当程序结束时，nodejs会返回该退出码。当进程完成所有处理后，程序正常退出。</p>
<p>使用nodejs启动服务器，例如HTTP服务器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> server = express()</span><br><span class="line"></span><br><span class="line">server.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">    res.send(<span class="string">'hello'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8080</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'服务器已就绪'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这个程序永远不会结束。如果调用process.exit()，则任何当前等待中或运行中的请求都会被终止，这不太友好。</p>
<p>这种情况下，需要向该命令发送SIGTERM信号，并使用进程的信号处理程序进行处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">    res.send(<span class="string">'hello'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = app.listen(<span class="number">8080</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>,log(<span class="string">'服务已就绪'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">process.on(<span class="string">'SIGTERM'</span>, () =&gt; &#123;</span><br><span class="line">    server.close(() = &gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'进程已终止'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>信号是一个POSIX内部通信系统：发送通知给进程，以告知发生的事件。</p>
<ul>
<li>SIGKILL：告诉进程立即停止的信号，理想情况下，类似process.exit()</li>
<li>SIGTERM：告诉进程正常终止的信号。</li>
</ul>
<p>可从程序内部的另一个函数中发送此信号：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.kill(process.pid, <span class="string">'SIGTERM'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="从nodejs读取环境变量"><a href="#从nodejs读取环境变量" class="headerlink" title="从nodejs读取环境变量"></a>从nodejs读取环境变量</h4><p>nodejs的process核心模块提供了env属性，承载了在启动进程时设置的所有环境变量。</p>
<p>访问NODE_ENV环境变量示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.env.NODE_ENV</span><br></pre></td></tr></table></figure>

<h4 id="命令行接收参数"><a href="#命令行接收参数" class="headerlink" title="命令行接收参数"></a>命令行接收参数</h4><p>获取参数值的方法是内置的process对象。公开一个argv属性，是一个包含所有命令行调用参数的数组。<br>第一个参数时node命令的完整路径，第二个参数时正被执行文件的完整路径。所有其他参数是从第三个位置开始的。</p>
<p>使用循环迭代所有参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">process.argv.forEach(<span class="function">(<span class="params">val, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;val&#125;</span>:<span class="subst">$&#123;index&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="使用exports从nodejs文件中公开功能"><a href="#使用exports从nodejs文件中公开功能" class="headerlink" title="使用exports从nodejs文件中公开功能"></a>使用exports从nodejs文件中公开功能</h4><p>nodejs是具有模块化，可以导入其他nodejs文件公开的内容。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> library = <span class="built_in">require</span>(<span class="string">'./library'</span>)</span><br></pre></td></tr></table></figure>

<p>可以导入存在当前文件夹下library.js文件中公开的功能。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出功能</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 另一个文件中</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">''</span>)</span><br></pre></td></tr></table></figure>

<h4 id="npm包管理器"><a href="#npm包管理器" class="headerlink" title="npm包管理器"></a>npm包管理器</h4><ul>
<li>–save安装并添加条目到package.json文件的dependencies</li>
<li>–save-dev安装并添加条目到package.json文件的devDependencies</li>
</ul>
<p>主要区别：devDependencies通常是开发的工具，而dependencies则是与生产环境中的应用程序相关。</p>
<p>npm有两种安装类型，本地安装和全局安装。<br>默认情况下是本地安装，软件包被安装到当前文件树种的node_modules子文件夹下。<br>这种情况下，npm还会在当前文件夹树种的package.json文件的dependencies属性中添加lodash条目。  </p>
<p>使用-g标志表示全局安装。</p>
<p><strong>运行任务</strong>：<br>package.json文件支持一种用于指定命令行任务的格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run &lt;task-name&gt;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="string">"start-dev"</span>: <span class="string">"node lib/server-development"</span>,</span><br><span class="line">        <span class="string">"start"</span>: <span class="string">"node lib/server-production"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用该特性运行webpack是很常见的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"script"</span>: &#123;</span><br><span class="line">        <span class="string">"watch"</span>: <span class="string">"webpack --watch --progress --colors --config webpack.conf.js"</span>,</span><br><span class="line">        <span class="string">"dev"</span>: <span class="string">"webpack --progress --colors --config webpack.conf.js"</span>,</span><br><span class="line">        <span class="string">"prod"</span>: <span class="string">"NODE_ENV=production webpack -p --config webpack.conf.js"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因此可以运行如下，而不是输入容易忘记或错误的长命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm run watch</span><br><span class="line">$ npm run dev</span><br><span class="line">$ npm run prod</span><br></pre></td></tr></table></figure>

<h4 id="package-json详解"><a href="#package-json详解" class="headerlink" title="package.json详解"></a>package.json详解</h4><p>package.json文件是项目的清单。可以做很多完全互不相关的事。例如，是工具的配置中心，也是npm和yarn存储所有已安装软件包的名称和版本的地方。</p>
<p>示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"test-project"</span>,             <span class="comment">// 用于告知应用程序或软件包的名称</span></span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,                 <span class="comment">// 当前版本</span></span><br><span class="line">  <span class="string">"description"</span>: <span class="string">"A Vue.js project"</span>,  <span class="comment">// 程序或软件包的简短描述</span></span><br><span class="line">  <span class="string">"main"</span>: <span class="string">"src/main.js"</span>,              <span class="comment">// 应用程序入口地址</span></span><br><span class="line">  <span class="string">"private"</span>: <span class="literal">true</span>,          <span class="comment">// 设置true可以防止应用程序/软件包被意外的发布到npm</span></span><br><span class="line">  <span class="string">"scripts"</span>: &#123;                        <span class="comment">// 定义了一组可运行的node脚本</span></span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --inline --progress --config build/webpack.dev.conf.js"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"npm run dev"</span>,</span><br><span class="line">    <span class="string">"unit"</span>: <span class="string">"jest --config test/unit/jest.conf.js --coverage"</span>,</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"npm run unit"</span>,</span><br><span class="line">    <span class="string">"lint"</span>: <span class="string">"eslint --ext .js,.vue src test/unit"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"node build/build.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;                  <span class="comment">// 设置了作为依赖安装的npm软件包列表</span></span><br><span class="line">    <span class="string">"vue"</span>: <span class="string">"^2.5.2"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;              <span class="comment">// 设置了作为开发依赖安装的npm软件包的列表</span></span><br><span class="line">    <span class="string">"autoprefixer"</span>: <span class="string">"^7.1.2"</span>,</span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.22.1"</span>,</span><br><span class="line">    <span class="string">"babel-eslint"</span>: <span class="string">"^8.2.1"</span>,</span><br><span class="line">    <span class="string">"babel-helper-vue-jsx-merge-props"</span>: <span class="string">"^2.0.3"</span>,</span><br><span class="line">    <span class="string">"babel-jest"</span>: <span class="string">"^21.0.2"</span>,</span><br><span class="line">    <span class="string">"babel-loader"</span>: <span class="string">"^7.1.1"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-dynamic-import-node"</span>: <span class="string">"^1.2.0"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-syntax-jsx"</span>: <span class="string">"^6.18.0"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-es2015-modules-commonjs"</span>: <span class="string">"^6.26.0"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-runtime"</span>: <span class="string">"^6.22.0"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-vue-jsx"</span>: <span class="string">"^3.5.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-env"</span>: <span class="string">"^1.3.2"</span>,</span><br><span class="line">    <span class="string">"babel-preset-stage-2"</span>: <span class="string">"^6.22.0"</span>,</span><br><span class="line">    <span class="string">"chalk"</span>: <span class="string">"^2.0.1"</span>,</span><br><span class="line">    <span class="string">"copy-webpack-plugin"</span>: <span class="string">"^4.0.1"</span>,</span><br><span class="line">    <span class="string">"css-loader"</span>: <span class="string">"^0.28.0"</span>,</span><br><span class="line">    <span class="string">"eslint"</span>: <span class="string">"^4.15.0"</span>,</span><br><span class="line">    <span class="string">"eslint-config-airbnb-base"</span>: <span class="string">"^11.3.0"</span>,</span><br><span class="line">    <span class="string">"eslint-friendly-formatter"</span>: <span class="string">"^3.0.0"</span>,</span><br><span class="line">    <span class="string">"eslint-import-resolver-webpack"</span>: <span class="string">"^0.8.3"</span>,</span><br><span class="line">    <span class="string">"eslint-loader"</span>: <span class="string">"^1.7.1"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-import"</span>: <span class="string">"^2.7.0"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-vue"</span>: <span class="string">"^4.0.0"</span>,</span><br><span class="line">    <span class="string">"extract-text-webpack-plugin"</span>: <span class="string">"^3.0.0"</span>,</span><br><span class="line">    <span class="string">"file-loader"</span>: <span class="string">"^1.1.4"</span>,</span><br><span class="line">    <span class="string">"friendly-errors-webpack-plugin"</span>: <span class="string">"^1.6.1"</span>,</span><br><span class="line">    <span class="string">"html-webpack-plugin"</span>: <span class="string">"^2.30.1"</span>,</span><br><span class="line">    <span class="string">"jest"</span>: <span class="string">"^22.0.4"</span>,</span><br><span class="line">    <span class="string">"jest-serializer-vue"</span>: <span class="string">"^0.3.0"</span>,</span><br><span class="line">    <span class="string">"node-notifier"</span>: <span class="string">"^5.1.2"</span>,</span><br><span class="line">    <span class="string">"optimize-css-assets-webpack-plugin"</span>: <span class="string">"^3.2.0"</span>,</span><br><span class="line">    <span class="string">"ora"</span>: <span class="string">"^1.2.0"</span>,</span><br><span class="line">    <span class="string">"portfinder"</span>: <span class="string">"^1.0.13"</span>,</span><br><span class="line">    <span class="string">"postcss-import"</span>: <span class="string">"^11.0.0"</span>,</span><br><span class="line">    <span class="string">"postcss-loader"</span>: <span class="string">"^2.0.8"</span>,</span><br><span class="line">    <span class="string">"postcss-url"</span>: <span class="string">"^7.2.1"</span>,</span><br><span class="line">    <span class="string">"rimraf"</span>: <span class="string">"^2.6.0"</span>,</span><br><span class="line">    <span class="string">"semver"</span>: <span class="string">"^5.3.0"</span>,</span><br><span class="line">    <span class="string">"shelljs"</span>: <span class="string">"^0.7.6"</span>,</span><br><span class="line">    <span class="string">"uglifyjs-webpack-plugin"</span>: <span class="string">"^1.1.1"</span>,</span><br><span class="line">    <span class="string">"url-loader"</span>: <span class="string">"^0.5.8"</span>,</span><br><span class="line">    <span class="string">"vue-jest"</span>: <span class="string">"^1.0.2"</span>,</span><br><span class="line">    <span class="string">"vue-loader"</span>: <span class="string">"^13.3.0"</span>,</span><br><span class="line">    <span class="string">"vue-style-loader"</span>: <span class="string">"^3.0.1"</span>,</span><br><span class="line">    <span class="string">"vue-template-compiler"</span>: <span class="string">"^2.5.2"</span>,</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^3.6.0"</span>,</span><br><span class="line">    <span class="string">"webpack-bundle-analyzer"</span>: <span class="string">"^2.9.0"</span>,</span><br><span class="line">    <span class="string">"webpack-dev-server"</span>: <span class="string">"^2.9.1"</span>,</span><br><span class="line">    <span class="string">"webpack-merge"</span>: <span class="string">"^4.1.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"engines"</span>: &#123;          <span class="comment">// 设置了此软件包/应用程序在那个版本的nodejs上运行</span></span><br><span class="line">    <span class="string">"node"</span>: <span class="string">"&gt;= 6.0.0"</span>,</span><br><span class="line">    <span class="string">"npm"</span>: <span class="string">"&gt;= 3.0.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"browserslist"</span>: [<span class="string">"&gt; 1%"</span>, <span class="string">"last 2 versions"</span>, <span class="string">"not ie &lt;= 8"</span>] <span class="comment">// 用于告知要支持哪些浏览器（及其版本）</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>属性分类：</p>
<ul>
<li>name：设置软件包的名称</li>
<li>author：列出软件包的作者名称</li>
<li>contributors： 除作者外，项目可以有一个或多个贡献者</li>
<li>homepage：设置软件包的主页</li>
<li>version：指定软件包当前版本（主版本号、次版本号、补丁版本号）</li>
<li>license：指定软件包的许可证</li>
<li>keywords：包含与软件包功能相关的关键字数组</li>
<li>description：对软件包的简短描述</li>
<li>repository：指定此程序包仓库所在的位置</li>
<li>main：设置软件包的入口点</li>
<li>private：如果设置为 true 可以防止应用程序/软件包被意外发布到 npm 上。</li>
<li>scripts：可以定义一组可以运行的 node 脚本。</li>
<li>dependencies：设置作为依赖安装的 npm 软件包的列表</li>
<li>devDependencies：设置作为开发依赖安装的 npm 软件包的列表</li>
<li>engines：设置此软件包/应用程序要运行的 Node.js 或其他命令的版本。</li>
<li>browserslist：用于告知要支持哪些浏览器（及其版本）</li>
</ul>
<h4 id="package-lock-json文件"><a href="#package-lock-json文件" class="headerlink" title="package-lock.json文件"></a>package-lock.json文件</h4><p>该文件==旨在跟踪被安装的每个软件包的确切版本==，以便产品可以以相同的方式被100%复制。</p>
<p>这解决了package.json一直尚未解决的特殊问题。在 package.json 中，可以使用 semver 表示法设置要升级到的版本（补丁版本或次版本）</p>
<p>无需将node_modules文件夹提交到git，在另一台机器上复制项目使用npm install就可。</p>
<p>原始的项目和新初始化的项目实际上是不同的。及时补丁版本或此版本不应该引入重大的更改，但还是可能引入缺陷。</p>
<p>package-lock.json 会固化当前安装的每个软件包的版本，当运行 npm install时，npm 会使用这些确切的版本。</p>
<p>==package-lock.json需要被提交到git仓库，以便被其他人获取。==</p>
<h4 id="使用npm的语义版本控制"><a href="#使用npm的语义版本控制" class="headerlink" title="使用npm的语义版本控制"></a>使用npm的语义版本控制</h4><p>所有版本有三个数字：x,y,z</p>
<ul>
<li>第一个数字是主版本。</li>
<li>第二个数字是次版本。</li>
<li>第三个数字是补丁版本。</li>
</ul>
<p>当发布新版本时，要遵循以下规则：</p>
<ul>
<li>进行不兼容API更改时，升级主版本</li>
<li>当以向后兼容的方式添加功能时，则升级次版本。</li>
<li>当进行向后兼容的缺陷修复时，升级补丁版本。</li>
</ul>
<p>npm设置了一些规则，可用在package.json文件中选择要将软件包更新到的版本（当运行npm update时）  </p>
<p>规则：</p>
<ul>
<li>^：如果写入^0.13.0，则当运行npm update时，会更新到补丁版本或次版本：即0.13.1、0.14.0</li>
<li>~：如果写入~0.13.0，则当运行npm update时，会更新到补丁版本：即0.13.1可以，0.14.0不可以</li>
<li>&gt;：接受高于指定版本的任何版本</li>
<li>&gt;=: 接受等于或高于指定版本的任何版本。</li>
<li>&lt;=: 接受等于或低于指定版本的任何版本。</li>
<li>&lt;: 接受低于指定版本的任何版本。</li>
<li>=: 接受确切的版本。</li>
<li>-: 接受一定范围的版本。例如：2.1.0 - 2.6.2。</li>
<li>||: 组合集合。例如 &lt; 2.1 || &gt; 2.6。</li>
</ul>
<h4 id="卸载npm软件包"><a href="#卸载npm软件包" class="headerlink" title="卸载npm软件包"></a>卸载npm软件包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall &lt;package-name&gt;</span><br></pre></td></tr></table></figure>

<p>如果使用-S或–save标志，则会移除package.json文件中的引用。</p>
<p>如果程序包是开发依赖项（列出在package.json文件的devDependencies中），必须使用-D或–save-dev标志从文件中删除.</p>
<p>如果该软件包是全局安装的，则需要添加 -g 或 –global 标志：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall -S &lt;package-name&gt;</span><br><span class="line">npm uninstall -D &lt;package-name&gt;</span><br><span class="line">npm uninstall -g &lt;package-name&gt;</span><br></pre></td></tr></table></figure>

<h4 id="nodejs包运行器npx"><a href="#nodejs包运行器npx" class="headerlink" title="nodejs包运行器npx"></a>nodejs包运行器npx</h4><p>npx是一个非常强大的命令，从npm5.2版本可用。<br>npx可以运行使用nodejs构建并通过npm仓库发布的代码。</p>
<ul>
<li>轻松的运行本地命令</li>
<li>无需安装的命令执行  </li>
<li>使用不同的nodejs版本运行代码</li>
<li>直接从URL运行任意代码片段</li>
</ul>
<h4 id="nodejs事件循环"><a href="#nodejs事件循环" class="headerlink" title="nodejs事件循环"></a>nodejs事件循环</h4><p>事件循环是了解nodejs最重要的方面之一。它==阐明了nodejs如何做到异步且具有非阻塞的I/O==。</p>
<p>==Node.js JavaScript代码运行在单个线程上==。每次只处理一件事。这个限制大大简化了编程方式，而不必担心并发问题。只需要注意如何编写代码，并避免任何可能阻塞线程的事情，例如同步的网络调用或无限的循环。</p>
<p>大多数浏览器中，每个浏览器选项卡都有一个事件循环，以使每个进程都隔离开，并避免使用无限的循环或繁重的处理来阻止整个浏览器的网页。</p>
<p>主要需要关心代码会在单个事件循环上运行。</p>
<p><strong>阻塞事件循环</strong>：任何花费太长时间才能将控制权返回给事件循环的JavaScript代码，都会阻塞页面中任何JavaScript代码的执行，甚至阻塞UI线程、用户无法单机浏览、滚动页面等。</p>
<p>==JavaScript 中几乎所有的 I/O 基元都是非阻塞的==。 网络请求、文件系统操作等。 被阻塞是个异常，这就是 JavaScript 如此之多基于回调（最近越来越多基于 promise 和 async/await）的原因。</p>
<p><strong>调用堆栈</strong>：事件循环不断调用堆栈，以检查是否需要运行任何函数。</p>
<p>执行时，将找到的所有函数调用添加到调用堆栈中，并顺序执行每个函数。</p>
<p>example：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'bar'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baz = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'baz'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line">  bar()</span><br><span class="line">  baz()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo()</span><br></pre></td></tr></table></figure>

<p>调用堆栈如图：<br><img src="http://nodejs.cn/static/270ebeb6dbfa7d613152b71257c72a9e/11a8f/call-stack-first-example.png" alt="image"></p>
<p>每次迭代中的事件循环都会查看调用堆栈中是否有东西并执行它直到调用堆栈为空。</p>
<p><strong>入队函数执行</strong>：<br>如何将函数推迟直到堆栈被清空。传统的回调函数，例如setTimeout。用例是调用一个函数，但是在代码中的其他函数已被执行之后。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'bar'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baz = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'baz'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line">  setTimeout(bar, <span class="number">0</span>)</span><br><span class="line">  baz()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出</span></span><br><span class="line">foo</span><br><span class="line">baz</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>

<p>此时的调用堆栈为：<br><img src="http://nodejs.cn/static/be55515b9343074d00b43de88c495331/966a0/call-stack-second-example.png" alt="image"></p>
<p><strong>消息队列</strong>：当调用setTimeout()时，浏览器或nodejs会启动定时器。当定时器到期时，回调函数被放入消息队列中。</p>
<p>在消息队列中，用户触发的事件会在此排队，然后带队才有机会对其作出反应。</p>
<p>==<strong>事件循环会赋予调用堆栈优先级，首先处理在调用堆栈中找到的所有东西，一旦其中没有任何东西，便开始处理消息队列中的东西。</strong>==</p>
<p>ES6作业队列：ECMAScript 2015引入了作业队列的概念，Promise使用了该队列。这种方式会尽快执行异步函数的结果，而不是放在调用堆栈的末尾。</p>
<p>在当前函数结束之前resolve的Promise会在当前函数之后被立即执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'bar'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baz = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'baz'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line">    setTimeout(bar, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> </span><br><span class="line">        resolve(<span class="string">'baz之后，bar之前'</span>)</span><br><span class="line">    ).then(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">console</span>.log(resolve))</span><br><span class="line">    baz()</span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果为</span></span><br><span class="line">foo</span><br><span class="line">baz</span><br><span class="line">baz之后，bar之前</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>

<p>这是Promise（以及基于promise构建的async/await）与通过setTimeout()或其他平台API的普通的旧异步函数之间的巨大区别。</p>
<h4 id="了解process-nextTick"><a href="#了解process-nextTick" class="headerlink" title="了解process.nextTick()"></a>了解process.nextTick()</h4><p>每当事件循环进行一次完整的行程时，将其称为一个滴答。</p>
<p>当将一个函数传给process.nextTick()时，则指示引擎在当前操作结束（在下一个事件循环滴答开始之前）调用此函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>当操作结束时，JS引擎会运行在该操作期间传给nextTick调用的所有函数。</p>
<p>调用setTimeout会在下一个滴答结束时执行该函数，比使用nextTick()晚的多。</p>
<p>当要确保在下一个事件循环迭代中代码已被执行，则使用nextTick()</p>
<h4 id="了解setImmediate"><a href="#了解setImmediate" class="headerlink" title="了解setImmediate()"></a>了解setImmediate()</h4><p>当要异步的（但要尽可能快）执行某些代码时，其中一个选择是使用nodejs提供的setImmediate()函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setImmediate(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>作为 setImmediate() 参数传入的任何函数都是在事件循环的下一个迭代中执行的回调。</p>
<p>传给process.nextTick()的函数会在时间循环的当前迭代中（当前操作结束之后）被执行。它始终在setTimeout和setImmediate之前执行。</p>
<h4 id="nodejs事件触发器"><a href="#nodejs事件触发器" class="headerlink" title="nodejs事件触发器"></a>nodejs事件触发器</h4><p>浏览器中用户的交互是通过事件：鼠标点击、键盘按键、鼠标移动等等。</p>
<p>在后端，nodejs提供了events模块构建类似系统的选项。特别的，这个模块提供了EventEmitter类，使用它来处理事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="keyword">const</span> eventEmitter = <span class="keyword">new</span> EventEmitter()</span><br></pre></td></tr></table></figure>

<p>和其他方法一样，此对象公开了on和emit方法</p>
<ul>
<li>emit用于触发事件</li>
<li>on用于添加一个回调函数，该函数在事件触发时执行</li>
</ul>
<p>例如，创建一个start事件，通过console来响应</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eventEmitter.on(<span class="string">'start'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'startes'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>当运行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eventEmitter.emit(<span class="string">'start'</span>)</span><br></pre></td></tr></table></figure>

<p>事件处理程序函数被触发。也可以传递参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eventEmitter.on(<span class="string">'start'</span>, number =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`started <span class="subst">$&#123;number&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">eventEmitter.emit(<span class="string">'start'</span>, <span class="number">23</span>)</span><br></pre></td></tr></table></figure>

<p>或者传多个参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eventEmitter.on(<span class="string">'start'</span>, (start, end) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`started from <span class="subst">$&#123;start&#125;</span> to <span class="subst">$&#123;end&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">eventEmitter.emit(<span class="string">'start'</span>, <span class="number">1</span>, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<p>EventEmitter还公开了几个与事件交互的其他方法</p>
<ul>
<li>once(): 添加一次性监听器</li>
<li>removeListener()/ off()：从事件删除事件监听器</li>
<li>removeAllListeners()：删除事件所有的监听器</li>
</ul>
<h4 id="搭建http服务器"><a href="#搭建http服务器" class="headerlink" title="搭建http服务器"></a>搭建http服务器</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.statusCode = <span class="number">200</span></span><br><span class="line">    res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/html'</span>)</span><br><span class="line">    res.end(<span class="string">'hello world'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(port, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`server is running at port <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="使用nodejs发送HTTP请求"><a href="#使用nodejs发送HTTP请求" class="headerlink" title="使用nodejs发送HTTP请求"></a>使用nodejs发送HTTP请求</h4><p>准备一个get请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">    hostname: <span class="string">'localhost'</span>,</span><br><span class="line">    port: <span class="number">8089</span>,</span><br><span class="line">    path: <span class="string">'/todo'</span>,</span><br><span class="line">    method: <span class="string">'GET'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> req = https.request(options, res =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`statusCode: <span class="subst">$&#123;res.statusCode&#125;</span>`</span>)</span><br><span class="line">    </span><br><span class="line">    res.on(<span class="string">'data'</span>, data =&gt; &#123;</span><br><span class="line">        process.stdout.write(data)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    res.on(<span class="string">'error'</span>, err =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    res.end()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>一个post请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>)</span><br><span class="line"><span class="keyword">const</span> data = <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">    name: <span class="string">'zhangsan'</span>,</span><br><span class="line">    age: <span class="number">23</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">    hostname: <span class="string">'localhost'</span>,</span><br><span class="line">    port: <span class="number">8089</span>,</span><br><span class="line">    path: <span class="string">'/todo'</span>,</span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>,</span><br><span class="line">        <span class="string">'Content-Length'</span>: data.length</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> req = https.request(options, res =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`statusCode:<span class="subst">$&#123;res.statusCode&#125;</span>`</span>)</span><br><span class="line">    </span><br><span class="line">    res.on(<span class="string">'data'</span>, data =&gt; &#123;</span><br><span class="line">        process.stdout.write(d)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    res.on(<span class="string">'error'</span>, err =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    res.write(data)</span><br><span class="line">    res.end()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>PUT和DELETE请求和POST格式相同。只是改变option.method值</p>
<h3 id="使用nodejs发送HTTP-post请求"><a href="#使用nodejs发送HTTP-post请求" class="headerlink" title="使用nodejs发送HTTP post请求"></a>使用nodejs发送HTTP post请求</h3><p>在node中执行post方式有很多种，取决于使用的抽象级别</p>
<p>使用axios请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>)</span><br><span class="line"></span><br><span class="line">axios</span><br><span class="line">  .post(<span class="string">'http://localhost'</span>, &#123;</span><br><span class="line">      name: <span class="string">'zhangsna'</span>,</span><br><span class="line">      pass: <span class="string">'123456'</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`statusCode: <span class="subst">$&#123;res.statusCode&#125;</span>`</span>)</span><br><span class="line">      <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(err)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>axios需要使用第三方库。</p>
<p>POST请求也可只使用nodejs标准模块</p>
<h3 id="使用nodejs获取HTTP请求的正文数据"><a href="#使用nodejs获取HTTP请求的正文数据" class="headerlink" title="使用nodejs获取HTTP请求的正文数据"></a>使用nodejs获取HTTP请求的正文数据</h3><p>以下是从请求主体中提取以json形式发送的数据的方法。</p>
<p>如果使用的是express，则非常简单，使用body-parser模块<br>例如，要获得此主题的主体</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>)</span><br><span class="line"></span><br><span class="line">axios.post(<span class="string">'http://localhost'</span>, &#123;</span><br><span class="line">    message: <span class="string">'hello world'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>与之匹配的服务端代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extend</span>: <span class="literal">true</span>&#125;))</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.json())</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/todo'</span>, (req, res) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.body.message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>如果不使用express，需要做很多的工作。因为express抽象了很多。</p>
<p>要理解的关键问题是：当使用HTTP.createServer()初始化HTTP服务器时，服务器获得所有HTTP请求头而不是请求体时，将调用回调。</p>
<p>在连接回调中传递的请求对象是一个数据流。所以要侦听要处理的主体内容，而它是按块处理的。</p>
<p>首先监听流data事件来获取数据，当数据结束时，调用流end事件，一次</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> data = []</span><br><span class="line">    req.on(<span class="string">'data'</span>, chunk =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`data chunk available: <span class="subst">$&#123;chunk&#125;</span>`</span>)</span><br><span class="line">        data.push(chunk)</span><br><span class="line">    &#125;)</span><br><span class="line">    req.on(<span class="string">'end'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="在nodejs中使用文件描述符"><a href="#在nodejs中使用文件描述符" class="headerlink" title="在nodejs中使用文件描述符"></a>在nodejs中使用文件描述符</h3><p>在与文件交互前，必须要得到一个文件描述符<br>文件描述符是通过使用fs模块提供的open()方法打开文件返回的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.open(<span class="string">'./file.js'</span>, <span class="string">'r'</span>, (err, fd) =&gt; &#123;</span><br><span class="line">    <span class="comment">// fd就是一个文件描述符</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>fs.openSync方法打开文件，返回文件描述符，而不是在回调中提供。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fs = fs.openSync(<span class="string">'./file.js'</span>, <span class="string">'r'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="nodejs文件属性"><a href="#nodejs文件属性" class="headerlink" title="nodejs文件属性"></a>nodejs文件属性</h3><p>每个文件都带有一组详细信息，可以使用fs模块的stat()方法</p>
<p>传递一个文件路径，一旦nodejs获得文件细节，调用传递的回调函数，有两个参数：错误信息和文件描述</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.stat(<span class="string">'./file.js'</span>, (err, stats) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>nodejs还提供一种同步方法，阻止线程直到文件统计信息就绪</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> stats = fs.statSync(<span class="string">'./file.js'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件信息包含在stats变量中，我们可以获得的信息有：</p>
<ul>
<li>如果文件是目录或文件，则使用stats.isFile()和stats.isDirectory()</li>
<li>如果文件是一个链接，则使用stats.isSymbolicLink()</li>
<li>使用stats.size查看文件大小<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.stat(<span class="string">'/Users/joe/test.txt'</span>, (err, stats) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  stats.isFile() <span class="comment">//true</span></span><br><span class="line">  stats.isDirectory() <span class="comment">//false</span></span><br><span class="line">  stats.isSymbolicLink() <span class="comment">//false</span></span><br><span class="line">  stats.size <span class="comment">//1024000 //= 1MB</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="nodejs文件路径"><a href="#nodejs文件路径" class="headerlink" title="nodejs文件路径"></a>nodejs文件路径</h3><p>从路径中获得信息：</p>
<ul>
<li>dirname：获得文件父文件夹路径</li>
<li>basename：文件名部分</li>
<li>extname：文件扩展名</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="string">'/users/joe/notes.txt'</span></span><br><span class="line"></span><br><span class="line">path.dirname(url) <span class="comment">// /users/joe</span></span><br><span class="line">path.basename(url) <span class="comment">// notes.txt</span></span><br><span class="line">path.extname(url) <span class="comment">// .txt</span></span><br></pre></td></tr></table></figure>

<p>可以为basename指定第二个参数来获得不带扩展名的文件名</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.basename(url, path.extname(url))  <span class="comment">// notes</span></span><br></pre></td></tr></table></figure>

<h4 id="path的一些方法"><a href="#path的一些方法" class="headerlink" title="path的一些方法"></a>path的一些方法</h4><p>使用 ==path.join()== 连接路径的多个部分</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">'aaa'</span></span><br><span class="line"></span><br><span class="line">path.join(<span class="string">'/'</span>, <span class="string">'users'</span>, name, <span class="string">'file.js'</span>)  <span class="comment">// '/users/aaa/file.js'</span></span><br></pre></td></tr></table></figure>

<p>使用 path.resolve() 得到绝对路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path.resolve(<span class="string">'file.js'</span>)  <span class="comment">// '/users/aaa/file.js'</span></span><br><span class="line"><span class="comment">// 再添加文件夹</span></span><br><span class="line">path.resolve(<span class="string">'tmp'</span>, <span class="string">'file.js'</span>)  <span class="comment">// '/users/aaa/tmp/file.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果第一个参数带有 / ,表示这是一个绝对路径</span></span><br><span class="line">path.resolve(<span class="string">'/ect'</span>, <span class="string">'file.js'</span>)  <span class="comment">// '/etc/file.js'</span></span><br></pre></td></tr></table></figure>

<p>path.normalize() 在路径中包含相对说明符 . 或 .. 或 // 时，计算实际的路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.normalize(<span class="string">'/users/joe/..//test.txt'</span>) <span class="comment">///users/test.txt</span></span><br></pre></td></tr></table></figure>

<p>但是resolve和normalize都不会检查路径存不存在。只根据获得的信息计算路径。</p>
<h3 id="nodejs读文件"><a href="#nodejs读文件" class="headerlink" title="nodejs读文件"></a>nodejs读文件</h3><p>fs.readFile()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'/users/aaa/file.js'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>同样有一种同步的方法readFileSync</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    data = fs.readFileSync(<span class="string">'/users/aaa/file.js'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="nodejs写文件"><a href="#nodejs写文件" class="headerlink" title="nodejs写文件"></a>nodejs写文件</h3><p>最简单的方法是使用fs.writeFile()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> content = <span class="string">'asdkdlfa'</span></span><br><span class="line"></span><br><span class="line">fs.writeFile(<span class="string">'/user/aaa/test.txt'</span>, content, err =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'success'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>同步的方法writeFileSync</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> content = <span class="string">'sdafasf'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    fs.writeFileSync(<span class="string">'/user/aaa/test.txt'</span>, content)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果文件已经存在，默认则会改变其中的内容。</p>
<p>可以通过指定flag来修改默认</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fs.writeFile(<span class="string">'/user/aaa/test.txt'</span>, content, &#123;<span class="attr">flag</span>: <span class="string">'a+'</span>&#125;, err =&gt; &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>flag有：</p>
<ul>
<li>r+ ：打开文件读和写</li>
<li>w+ ： 打开文件进行读写，将流放在文件的开头。如果文件不存在就创建</li>
<li>a ： 打开要写入的文件，将流放在文件末尾。如果文件不存在就创建</li>
<li>a+ ： 打开文件进行读写，将流放在文件末尾，如果文件不存在则创建</li>
</ul>
<p>将内容追加到文件末尾的快捷方式是： fs.appendFile()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> content = <span class="string">'sdafasf'</span></span><br><span class="line"></span><br><span class="line">fs.appendFile(<span class="string">'file.log'</span>, content, err =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="nodejs中使用文件夹"><a href="#nodejs中使用文件夹" class="headerlink" title="nodejs中使用文件夹"></a>nodejs中使用文件夹</h3><p>nodejs模块fs可以很多方法可以处理文件夹  </p>
<ol>
<li><p>检查文件夹是否存在：fs.access()</p>
</li>
<li><p>创建一个新的文件夹：fs.mkdir()或fs.mkdirSync</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> folderName = <span class="string">'/Users/joe/test'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!fs.existsSync(foldName) &#123;</span><br><span class="line">        fs.mkdirSync(foldName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>读取目录的内容：fs.readdir()或fs.readdirSync()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取文件夹中文件和子文件夹内容，返回他们的相对路径</span></span><br><span class="line">cosnt fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> folderPath = <span class="string">'/users/aaa'</span></span><br><span class="line"></span><br><span class="line">fs.readdirSync(folderPath)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>得到完整的path</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fs.readdirSync(folderPath).map(<span class="function"><span class="params">fileName</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> path.join(folderPath, fileName)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>过滤、仅返回文件类型</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isFile = <span class="function"><span class="params">fileName</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fs.lstatSync(fileName).isFile</span><br><span class="line">&#125;</span><br><span class="line">fs.readdirSync(folderPath).map(<span class="function"><span class="params">fileName</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> path.join(folderPath, fileName)</span><br><span class="line">&#125;).filter(isFile)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>重命名一个文件夹: fs.rename() 或 fs.renameSync()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.rename(<span class="string">'/users/aaa'</span>, <span class="string">'users/bbb'</span>, err =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>fs.renameSync()方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    fs.renameSync(<span class="string">'/users/aaa'</span>, <span class="string">'/users/bbb'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>移除文件夹: fs.rmdir() 或 fs.rmdirSync()</li>
</ol>
<p>删除包含内容的文件夹比较复杂，安装fs-extra模块，是fs模块的替代品，在它之上提供了更多的功能。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> folder = <span class="string">'/users/aaa'</span></span><br><span class="line"></span><br><span class="line">fs.remove(folder, err =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>也可以和promise一起使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fs.remove(folder)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// done</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(err)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>或者和async/await一起使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">removeFolder</span>(<span class="params">folder</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> fs.remove(folder)</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> folder = <span class="string">'/users/aaa'</span></span><br><span class="line">removeFolder(folder)</span><br></pre></td></tr></table></figure>

<h3 id="nodejs文件系统模块"><a href="#nodejs文件系统模块" class="headerlink" title="nodejs文件系统模块"></a>nodejs文件系统模块</h3><p>方法包括：</p>
<ul>
<li>fs.access()：检查文件是否存在</li>
<li>fs.appendFile()：将数据添加到文件中，如果文件不存在，则创建它</li>
<li>fs.chmod()：更改由文件名指定的文件的权限</li>
<li>fs.chown()：更改由文件名指定的文件所有者和群体</li>
<li>fs.close()：关闭一个文件</li>
<li>fs.copyFile()：拷贝一个文件</li>
<li>fs.createReadStream()：创建一个读文件流</li>
<li>fs.createWriteStream()：创建一个写文件流</li>
<li>fs.mkdir()：创建一个文件夹</li>
<li>fs.mkdtemp()：创建一个临时目录</li>
<li>fs.open(): 设置文件模式</li>
<li>fs.readdir()：读取目录的内容</li>
<li>fs.readFile()：读取文件内容</li>
<li>fs.readLink()：读取符号链接的值</li>
<li>fs.realpath()：将相对路径解析成完整路径</li>
<li>fs.rename()：重命名一个文件或文件夹</li>
<li>fs.rmdir()：移除一个文件夹</li>
<li>fs.stat()：返回文件状态</li>
<li>fs.synlink()：为文件创建一个符号链接</li>
<li>fs.truncate()：将文件截断为指定长度</li>
<li>fs.unlink()：移除一个文件或符号链接</li>
<li>fs.unwatchFile()：停止对文件的监听</li>
<li>fs.utimes()：更改文件的时间戳</li>
<li>fs.watchFile()：开始监听文件的改变</li>
<li>fs.writeFile()：将数据写入文件</li>
</ul>
<h3 id="nodejs路径模块"><a href="#nodejs路径模块" class="headerlink" title="nodejs路径模块"></a>nodejs路径模块</h3><ul>
<li>path.basename()</li>
<li>path.dirname()</li>
<li>path.extname()</li>
<li>path.isAbsolute()</li>
<li>path.join()</li>
<li>path.normalize()</li>
<li>path.parse()</li>
<li>path.relative()</li>
<li>path.resolve()</li>
</ul>
<ol>
<li>path.basename()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line">path.basename(<span class="string">'/test/aaa'</span>)  <span class="comment">// aaa</span></span><br><span class="line">path.basename(<span class="string">'/test/aaa.txt'</span>) <span class="comment">// aaa.txt</span></span><br><span class="line">path.basename(<span class="string">'/test/aaa.txt'</span>, <span class="string">'txt'</span>) <span class="comment">// aaa</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>path.dirname()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path.dirname(<span class="string">'/test/aaa'</span>)  <span class="comment">// /test</span></span><br><span class="line">path.dirname(<span class="string">'/test/aaa/file.txt'</span>) <span class="comment">// /test/aaa</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>path.extname()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path.extname(<span class="string">'/test/something'</span>) <span class="comment">// ''</span></span><br><span class="line">path.extname(<span class="string">'/test/something/file.txt'</span>) <span class="comment">// '.txt'</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>path.isAbsolute()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path.isAbsolute(<span class="string">'/test/aaa'</span>)  <span class="comment">// true</span></span><br><span class="line">path.isAbsolute(<span class="string">'./test/aaa'</span>)  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>path.join()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">'aaa'</span></span><br><span class="line"></span><br><span class="line">path.join(<span class="string">'/'</span>, name, <span class="string">'bbb'</span>, <span class="string">'file.txt'</span>)</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>path.normalize()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.normalize(<span class="string">'/users/aaa/..//test.txt'</span>) <span class="comment">// '/users/test.txt'</span></span><br></pre></td></tr></table></figure>

<ol start="7">
<li>path.parse()<br>解析路径会得到以下：</li>
</ol>
<ul>
<li>root</li>
<li>dir</li>
<li>base</li>
<li>name</li>
<li>ext</li>
</ul>
<p>例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">path.parse(<span class="string">'/users/test.txt'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line">&#123;</span><br><span class="line">    root: <span class="string">'/'</span>,</span><br><span class="line">    dir: <span class="string">'/users'</span>,</span><br><span class="line">    base: <span class="string">'test.txt'</span>,</span><br><span class="line">    name: <span class="string">'test'</span>,</span><br><span class="line">    ext: <span class="string">'txt'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="8">
<li><p>path.relative()<br>接受2个路径作为参数。根据当前工作目录返回从第一个路径到第二个路径的相对路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path.relative(<span class="string">'/Users/joe'</span>, <span class="string">'/Users/joe/test.txt'</span>) <span class="comment">//'test.txt'</span></span><br><span class="line">path.relative(<span class="string">'/Users/joe'</span>, <span class="string">'/Users/joe/something/test.txt'</span>) <span class="comment">//'something/test.txt'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>path.resolve()<br>得到绝对的路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path.resolve(<span class="string">'file.txt'</span>) <span class="comment">// '/users/aaa/file.txt'</span></span><br><span class="line">path.resolve(<span class="string">'tmp'</span>, <span class="string">'file.txt'</span>) <span class="comment">// '/users/aaa/tmp/file.txt'</span></span><br><span class="line">path.resolve(<span class="string">'/etc'</span>, <span class="string">'file.txt'</span>)  <span class="comment">// '/etc/file.txt'</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="nodejs操作系统模块"><a href="#nodejs操作系统模块" class="headerlink" title="nodejs操作系统模块"></a>nodejs操作系统模块</h3><ul>
<li>os.arch()：返回基础架构的字符串，例如arm、x64，arm64</li>
<li>os.cpus(): 返回系统cpu相关信息</li>
<li>os.endianness()：根据使用Big Endian还是Little Endian编译nodejs，返回BE或LE</li>
<li>os.freemem()：返回代表系统中可用内存的字节数</li>
<li>os.homedir(): 将路径返回到当前用户的主目录</li>
<li>os.hostname()：得到host名字</li>
<li>os.loadavg()：返回操作系统对平均负载的计算。仅在linux和macOS上返回有意义值</li>
<li>os.networkInterfaces()：返回系统上可用网络接口的详细信息</li>
<li>os.platform()：返回为nodejs编译的平台</li>
<li>os.release()：返回标识操作系统版本号的字符串</li>
<li>os.tmpdir()：返回指定的临时文件夹的路径</li>
<li>os.totalmem()：返回标识系统中可用总内存的字节数</li>
<li>os.type()：操作系统标识符</li>
<li>os.uptime()：返回自上次重新启动以来计算机一直在运行的秒数</li>
</ul>
<h3 id="nodejs事件模块"><a href="#nodejs事件模块" class="headerlink" title="nodejs事件模块"></a>nodejs事件模块</h3><p>events模块提供了EventEmitter类，这是在nodejs中处理事件的关键</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line">cosnt emitter = <span class="keyword">new</span> EventEmitter()</span><br></pre></td></tr></table></figure>

<ol>
<li>emitter.addListener()：emitter.on()的别名</li>
<li>emitter.emit()：发生事件，按照注册事件的顺序同步调用每个事件侦听器</li>
<li>emitter.eventNames()：返回一个字符串数组，这些字符串标识在当前EventEmitter对象上注册的事件</li>
<li>emitter.getMaxListeners()：获得一个可以添加到EventEmitter对象的最大侦听器数量，默认为10，但可以使用setMaxListeners()进行增加或降低</li>
<li>emitter.listenerCount()：获取作为参数传递的事件的侦听器的数量</li>
<li>emitter.listeners()：获得作为参数传递的事件的侦听器数组</li>
<li>emitter.off()：emitter.removeListener()的别名</li>
<li>emitter.on(): 添加发出事件时调用的回调函数</li>
<li>emitter.once(): 回调只会被调用一次，不会再被调用</li>
<li>emitter.prependListener()：使用on或者addListener添加侦听器时，该侦听器被添加到侦听器队列中的最后一个，并被称为last。使用prependListener可以在其他侦听器之前添加并调用</li>
<li>emitter.prependOnceListener()：调用一次</li>
<li>emitter.removeListener()：删除特定的侦听器，可以让回调函数保存在一个变量中，便于引用</li>
<li>emitter.setMaxListeners()：设置一个可以添加到EventEmitter对象的侦听器的最大数量，默认为10</li>
</ol>
<h3 id="nodejs-http模块"><a href="#nodejs-http模块" class="headerlink" title="nodejs http模块"></a>nodejs http模块</h3><h4 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h4><ul>
<li>http.METHODS</li>
<li>http.STATUS_CODES</li>
<li>http.globalAgent</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">require</span>(<span class="string">'http'</span>).METHODS</span><br><span class="line">[ <span class="string">'ACL'</span>,</span><br><span class="line">  <span class="string">'BIND'</span>,</span><br><span class="line">  <span class="string">'CHECKOUT'</span>,</span><br><span class="line">  <span class="string">'CONNECT'</span>,</span><br><span class="line">  <span class="string">'COPY'</span>,</span><br><span class="line">  <span class="string">'DELETE'</span>,</span><br><span class="line">  <span class="string">'GET'</span>,</span><br><span class="line">  <span class="string">'HEAD'</span>,</span><br><span class="line">  <span class="string">'LINK'</span>,</span><br><span class="line">  <span class="string">'LOCK'</span>,</span><br><span class="line">  <span class="string">'M-SEARCH'</span>,</span><br><span class="line">  <span class="string">'MERGE'</span>,</span><br><span class="line">  <span class="string">'MKACTIVITY'</span>,</span><br><span class="line">  <span class="string">'MKCALENDAR'</span>,</span><br><span class="line">  <span class="string">'MKCOL'</span>,</span><br><span class="line">  <span class="string">'MOVE'</span>,</span><br><span class="line">  <span class="string">'NOTIFY'</span>,</span><br><span class="line">  <span class="string">'OPTIONS'</span>,</span><br><span class="line">  <span class="string">'PATCH'</span>,</span><br><span class="line">  <span class="string">'POST'</span>,</span><br><span class="line">  <span class="string">'PROPFIND'</span>,</span><br><span class="line">  <span class="string">'PROPPATCH'</span>,</span><br><span class="line">  <span class="string">'PURGE'</span>,</span><br><span class="line">  <span class="string">'PUT'</span>,</span><br><span class="line">  <span class="string">'REBIND'</span>,</span><br><span class="line">  <span class="string">'REPORT'</span>,</span><br><span class="line">  <span class="string">'SEARCH'</span>,</span><br><span class="line">  <span class="string">'SUBSCRIBE'</span>,</span><br><span class="line">  <span class="string">'TRACE'</span>,</span><br><span class="line">  <span class="string">'UNBIND'</span>,</span><br><span class="line">  <span class="string">'UNLINK'</span>,</span><br><span class="line">  <span class="string">'UNLOCK'</span>,</span><br><span class="line">  <span class="string">'UNSUBSCRIBE'</span> ]</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'http'</span>).STATUS_CODES</span><br><span class="line">&#123; <span class="string">'100'</span>: <span class="string">'Continue'</span>,</span><br><span class="line">  <span class="string">'101'</span>: <span class="string">'Switching Protocols'</span>,</span><br><span class="line">  <span class="string">'102'</span>: <span class="string">'Processing'</span>,</span><br><span class="line">  <span class="string">'200'</span>: <span class="string">'OK'</span>,</span><br><span class="line">  <span class="string">'201'</span>: <span class="string">'Created'</span>,</span><br><span class="line">  <span class="string">'202'</span>: <span class="string">'Accepted'</span>,</span><br><span class="line">  <span class="string">'203'</span>: <span class="string">'Non-Authoritative Information'</span>,</span><br><span class="line">  <span class="string">'204'</span>: <span class="string">'No Content'</span>,</span><br><span class="line">  <span class="string">'205'</span>: <span class="string">'Reset Content'</span>,</span><br><span class="line">  <span class="string">'206'</span>: <span class="string">'Partial Content'</span>,</span><br><span class="line">  <span class="string">'207'</span>: <span class="string">'Multi-Status'</span>,</span><br><span class="line">  <span class="string">'208'</span>: <span class="string">'Already Reported'</span>,</span><br><span class="line">  <span class="string">'226'</span>: <span class="string">'IM Used'</span>,</span><br><span class="line">  <span class="string">'300'</span>: <span class="string">'Multiple Choices'</span>,</span><br><span class="line">  <span class="string">'301'</span>: <span class="string">'Moved Permanently'</span>,</span><br><span class="line">  <span class="string">'302'</span>: <span class="string">'Found'</span>,</span><br><span class="line">  <span class="string">'303'</span>: <span class="string">'See Other'</span>,</span><br><span class="line">  <span class="string">'304'</span>: <span class="string">'Not Modified'</span>,</span><br><span class="line">  <span class="string">'305'</span>: <span class="string">'Use Proxy'</span>,</span><br><span class="line">  <span class="string">'307'</span>: <span class="string">'Temporary Redirect'</span>,</span><br><span class="line">  <span class="string">'308'</span>: <span class="string">'Permanent Redirect'</span>,</span><br><span class="line">  <span class="string">'400'</span>: <span class="string">'Bad Request'</span>,</span><br><span class="line">  <span class="string">'401'</span>: <span class="string">'Unauthorized'</span>,</span><br><span class="line">  <span class="string">'402'</span>: <span class="string">'Payment Required'</span>,</span><br><span class="line">  <span class="string">'403'</span>: <span class="string">'Forbidden'</span>,</span><br><span class="line">  <span class="string">'404'</span>: <span class="string">'Not Found'</span>,</span><br><span class="line">  <span class="string">'405'</span>: <span class="string">'Method Not Allowed'</span>,</span><br><span class="line">  <span class="string">'406'</span>: <span class="string">'Not Acceptable'</span>,</span><br><span class="line">  <span class="string">'407'</span>: <span class="string">'Proxy Authentication Required'</span>,</span><br><span class="line">  <span class="string">'408'</span>: <span class="string">'Request Timeout'</span>,</span><br><span class="line">  <span class="string">'409'</span>: <span class="string">'Conflict'</span>,</span><br><span class="line">  <span class="string">'410'</span>: <span class="string">'Gone'</span>,</span><br><span class="line">  <span class="string">'411'</span>: <span class="string">'Length Required'</span>,</span><br><span class="line">  <span class="string">'412'</span>: <span class="string">'Precondition Failed'</span>,</span><br><span class="line">  <span class="string">'413'</span>: <span class="string">'Payload Too Large'</span>,</span><br><span class="line">  <span class="string">'414'</span>: <span class="string">'URI Too Long'</span>,</span><br><span class="line">  <span class="string">'415'</span>: <span class="string">'Unsupported Media Type'</span>,</span><br><span class="line">  <span class="string">'416'</span>: <span class="string">'Range Not Satisfiable'</span>,</span><br><span class="line">  <span class="string">'417'</span>: <span class="string">'Expectation Failed'</span>,</span><br><span class="line">  <span class="string">'418'</span>: <span class="string">'I\'m a teapot'</span>,</span><br><span class="line">  <span class="string">'421'</span>: <span class="string">'Misdirected Request'</span>,</span><br><span class="line">  <span class="string">'422'</span>: <span class="string">'Unprocessable Entity'</span>,</span><br><span class="line">  <span class="string">'423'</span>: <span class="string">'Locked'</span>,</span><br><span class="line">  <span class="string">'424'</span>: <span class="string">'Failed Dependency'</span>,</span><br><span class="line">  <span class="string">'425'</span>: <span class="string">'Unordered Collection'</span>,</span><br><span class="line">  <span class="string">'426'</span>: <span class="string">'Upgrade Required'</span>,</span><br><span class="line">  <span class="string">'428'</span>: <span class="string">'Precondition Required'</span>,</span><br><span class="line">  <span class="string">'429'</span>: <span class="string">'Too Many Requests'</span>,</span><br><span class="line">  <span class="string">'431'</span>: <span class="string">'Request Header Fields Too Large'</span>,</span><br><span class="line">  <span class="string">'451'</span>: <span class="string">'Unavailable For Legal Reasons'</span>,</span><br><span class="line">  <span class="string">'500'</span>: <span class="string">'Internal Server Error'</span>,</span><br><span class="line">  <span class="string">'501'</span>: <span class="string">'Not Implemented'</span>,</span><br><span class="line">  <span class="string">'502'</span>: <span class="string">'Bad Gateway'</span>,</span><br><span class="line">  <span class="string">'503'</span>: <span class="string">'Service Unavailable'</span>,</span><br><span class="line">  <span class="string">'504'</span>: <span class="string">'Gateway Timeout'</span>,</span><br><span class="line">  <span class="string">'505'</span>: <span class="string">'HTTP Version Not Supported'</span>,</span><br><span class="line">  <span class="string">'506'</span>: <span class="string">'Variant Also Negotiates'</span>,</span><br><span class="line">  <span class="string">'507'</span>: <span class="string">'Insufficient Storage'</span>,</span><br><span class="line">  <span class="string">'508'</span>: <span class="string">'Loop Detected'</span>,</span><br><span class="line">  <span class="string">'509'</span>: <span class="string">'Bandwidth Limit Exceeded'</span>,</span><br><span class="line">  <span class="string">'510'</span>: <span class="string">'Not Extended'</span>,</span><br><span class="line">  <span class="string">'511'</span>: <span class="string">'Network Authentication Required'</span> &#125;</span><br></pre></td></tr></table></figure>

<p>http.globalAgent():<br>用于管理HTTP客户端的连接持久性和重用，是nodejs HTTP网络的关键组成部分</p>
<h4 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h4><ul>
<li>http.createServer()</li>
<li>http.request()：向服务器发出HTTP请求</li>
<li>http.get()：与http.request()类似，但会自动将http方法设置为GET，并自动调用req.end()</li>
</ul>
<h4 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h4><p>http模块提供了五种类</p>
<ul>
<li>http.Agent</li>
<li>http.ClientRequest</li>
<li>http.Server</li>
<li>http.ServerResponse</li>
<li>http.IncomingMessage</li>
</ul>
<p><strong>http.Agent</strong>:<br>nodejs创建http.Agent类的全局实例，以管理HTTP客户端的连接持久性和重用（Nodejs HTTP网络的关键组成部分）</p>
<p>该对象确保对服务器的每个请求都排队，并且重用单个socket</p>
<p>维护一个socket池</p>
<p><strong>http.ClientRequest</strong>:<br>当调用http.request()或http.get()时，将创建一个http.ClientRequest对象</p>
<p>接收到响应后，将使用http.IncomingMessage实例作为参数，调用响应事件</p>
<p>可通过两种方式读取响应的返回数据：</p>
<ul>
<li>使用response.read()方法</li>
<li>在响应事件处理程序中，可以为数据事件设置事件侦听器，以便可以侦听流入的事件</li>
</ul>
<p><strong>http.Server</strong>:<br>使用http.createServer()创建服务器时，通常会实例化返回类。有close和listen方法</p>
<ul>
<li>close()：阻止服务器接受新连接</li>
<li>listen()：启动HTTP服务器并侦听连接</li>
</ul>
<p><strong>http.ServerResponse</strong>:<br>由http.Server创建，并作为第二个参数传递给它触发的request事件<br>即res</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>始终在处理程序中调用的方法是end()，关闭响应，信息已完成，服务器可以将其发送给客户端。必须在每个响应上调用</p>
<p><strong>http.IncomingMessage</strong>：<br>一个http.IncomingMessage对象是通过以下方式创建</p>
<ul>
<li>http.Server监听request事件</li>
<li>http.ClientRequest监听response事件</li>
</ul>
<p>可以用来访问响应：</p>
<ul>
<li>状态使用statusCode和statusMessage方法</li>
<li>头部使用headers方法或rawHeaders</li>
<li>HTTP方法用method</li>
<li>HTTP版本使用httpVersion</li>
<li>URL使用url</li>
<li>underlying socket使用the socket </li>
</ul>
<p>由于http.IncomingMessage实现了Readable Stream接口，因此使用流访问数据。</p>
<h3 id="nodejs-Buffer"><a href="#nodejs-Buffer" class="headerlink" title="nodejs Buffer"></a>nodejs Buffer</h3><p>Buffer是一个内存区域，代表在V8 JavaScript引擎外部分配的固定大小的内存块（无法调整大小）。<br>可将Buffer看作一个整数数组，每个整数代表一个数据字节</p>
<p>引入Buffer帮助处理二进制数据。Buffer和stream紧密相连，将stream处理器接收数据的速度快与处理速度时，将数据放入Buffer中</p>
<h5 id="create-a-buffer"><a href="#create-a-buffer" class="headerlink" title="create a buffer"></a>create a buffer</h5><p>使用Buffer.from()，Buffer.alloc()，Buffer.allocUnsafe()方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buf = Buffer.from(<span class="string">'hey'</span>)</span><br><span class="line"><span class="keyword">const</span> buf = Buffer.alloc(<span class="number">1024</span>)</span><br><span class="line">buf.write(<span class="string">'XXX'</span>)</span><br><span class="line"><span class="keyword">const</span> buf = Buffer.allocUnsafe(<span class="number">1024</span>)</span><br></pre></td></tr></table></figure>

<p>虽然alloc和allocUnsafe都分配指定大小的Buffer，但alloc创建的Buffer将初始化为零，而allocUnsafe创建的Buffer没有初始化。 这意味着，尽管allocUnsafe与alloc相比要快得多，但分配的内存段可能包含可能敏感的旧数据。</p>
<h3 id="using-a-buffer"><a href="#using-a-buffer" class="headerlink" title="using a buffer"></a>using a buffer</h3><p>Buffer可以向数组一样进行访问</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buf = Buffer.from(<span class="string">'Hey!'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">0</span>]) <span class="comment">// 72</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">1</span>]) <span class="comment">// 101</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">2</span>]) <span class="comment">//121</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 可使用toString()方法</span></span><br><span class="line"><span class="built_in">console</span>.log(buf.toString())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到buffer的长度</span></span><br><span class="line"><span class="built_in">console</span>.log(buf.length)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对buffer内容的迭代</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">in</span> buffer) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改buffer内容</span></span><br><span class="line">buf[<span class="number">1</span>] = <span class="number">111</span> <span class="comment">// o</span></span><br><span class="line"><span class="built_in">console</span>.log(buf.toString()) <span class="comment">// Hoy</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 拷贝</span></span><br><span class="line">buf.copy(bufcopy)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Slice a buffer</span></span><br><span class="line">buf.slice(<span class="number">0</span>).toString()  <span class="comment">// Hey!</span></span><br><span class="line"><span class="keyword">const</span> slice = buf.slice(<span class="number">0</span>, <span class="number">2</span>)  <span class="comment">// He</span></span><br><span class="line">buf[<span class="number">1</span>] = <span class="number">111</span>  <span class="comment">// o</span></span><br><span class="line"><span class="built_in">console</span>.log(slice.toString()) <span class="comment">//Ho</span></span><br></pre></td></tr></table></figure>

<h3 id="nodejs-流"><a href="#nodejs-流" class="headerlink" title="nodejs 流"></a>nodejs 流</h3><p>流是支持nodejs应用程序的基本概念之一。以一种有效的方式处理读/写文件、网络通信或任何类型的端到端信息交换的方式。</p>
<p>使用流，可以逐段读取文件，在不将其全部保存在内存中的情况下处理其内容。</p>
<p>nodejs流模块提供了构建所有流API的基础。所有流都是EventEmitter的实例</p>
<p>相比于其他数据处理方法，流提供的两个主要优点：</p>
<ul>
<li>内存效率：处理数据之前，无需再内存中加载大量的数据</li>
<li>时间效率：拥有数据后立即开始处理数据，所需的时间更少，不必等到整个数据有效负载就可开始使用。</li>
</ul>
<h5 id="An-example-of-a-stream"><a href="#An-example-of-a-stream" class="headerlink" title="An example of a stream"></a>An example of a stream</h5><p>使用nodejs模块fs，可以读取我呢间，并在与HTTP服务器建立新连接时通过HTTP提供文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) =&gt; </span>&#123;</span><br><span class="line">    fs.readFile(path.resolve(<span class="string">'./data.txt'</span>), (err, data) =&gt; &#123;</span><br><span class="line">        res.end(data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8089</span>)</span><br></pre></td></tr></table></figure>

<p>readFile()读取文件的全部内容，并在完成后调用回调函数。<br>回调中的res.end(data)会将文件内容返回给HTTP客户端</p>
<p>如果文件很大，这个操作会花费大量的时间。使用流的代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> stream = fs.createReadStream(path.resolve(<span class="string">'./data.txt'</span>))</span><br><span class="line">    stream.pipe(res)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8089</span>)</span><br></pre></td></tr></table></figure>

<p>这没有等待文件完全读取，在准备好要发送的大量数据后立即开始将其流式传输到HTTP客户端</p>
<h5 id="pipe"><a href="#pipe" class="headerlink" title="pipe()"></a>pipe()</h5><p>上面示例使用stream.pipe(res)，在文件流上调用pipe()方法。它获取源数据并将其通过管道传递到HTTP response</p>
<p>pipe()方法的返回值是目标流，这使得可以链接多个pipe()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">src.pipe(dest1).pipe(dest2)</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">src.pipe(dest1)</span><br><span class="line">dest1.pipe(dest2)</span><br></pre></td></tr></table></figure>

<h5 id="Streams-powered-Node-js-APIs"><a href="#Streams-powered-Node-js-APIs" class="headerlink" title="Streams-powered Node.js APIs"></a>Streams-powered Node.js APIs</h5><p>很多nodejs核心模块提供了流的处理功能，最值得关注的有</p>
<ul>
<li>process.stdin：返回连接到stdin的流</li>
<li>process.stdout：返回连接到stdout的流</li>
<li>process.stderr：返回连接到stderr的流</li>
<li>fs.createReadStream()：创建文件可读流</li>
<li>fs.createWriteStream()：创建文件可写流</li>
<li>net.connect()：启动基于流的连接</li>
<li>http.request()：返回http.ClientRequest类的实例，该实例是可写流</li>
<li>zlib.createGzip()：使用gzip将数据压缩到流中</li>
<li>zlib.Gunzip()：解压缩gzip流</li>
<li>zlib.createDeflate()：使用deflate将数据压缩到流中</li>
<li>zlib.createInflate()：解压缩deflate流</li>
</ul>
<h5 id="流的类型"><a href="#流的类型" class="headerlink" title="流的类型"></a>流的类型</h5><ul>
<li>可读：可接受数据，但不能发送数据</li>
<li>可写：可发送数据，但不能从中接收数据</li>
<li>双工：可读流和可写流的组合，可同时输入、输出</li>
<li>转换：转换流类似于双工，但是输入和输出的转换</li>
</ul>
<h5 id="创建一个可读流"><a href="#创建一个可读流" class="headerlink" title="创建一个可读流"></a>创建一个可读流</h5><p>从stream模块获取可读流，并对其进行初始化实现read._read()方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个流对象</span></span><br><span class="line"><span class="keyword">const</span> Stream = <span class="built_in">require</span>(<span class="string">'stream'</span>)</span><br><span class="line"><span class="keyword">const</span> readableStream = <span class="keyword">new</span> Stream.Readable()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后执行_read</span></span><br><span class="line">readableStream._read = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在初始化后</span></span><br><span class="line">readableStream.push(<span class="string">'hi!'</span>)</span><br><span class="line">readableStream.push(<span class="string">'ho!'</span>)</span><br></pre></td></tr></table></figure>

<h5 id="创建一个可写流"><a href="#创建一个可写流" class="headerlink" title="创建一个可写流"></a>创建一个可写流</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Stream = <span class="built_in">require</span>(<span class="string">'stream'</span>)</span><br><span class="line"><span class="keyword">const</span> WritableStream = <span class="keyword">new</span> Stream.Writable()</span><br><span class="line"></span><br><span class="line">writableStream._write = <span class="function">(<span class="params">chunk, encoding, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(chunk.toString())</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">process.stdin.pipe(writableStream)</span><br></pre></td></tr></table></figure>

<h5 id="从可读流中得到数据"><a href="#从可读流中得到数据" class="headerlink" title="从可读流中得到数据"></a>从可读流中得到数据</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Stream = <span class="built_in">require</span>(<span class="string">'stream'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readableStream = <span class="keyword">new</span> Stream.Readable(&#123;</span><br><span class="line">    read() &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> writableStream = <span class="keyword">new</span> Stream.Writable()</span><br><span class="line"></span><br><span class="line">writableStream._write = <span class="function">(<span class="params">chunk, encoding, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(chunk.toString())</span><br><span class="line">    next()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">readableStream.pipe(writableStream)</span><br><span class="line"></span><br><span class="line">readableStream.push(<span class="string">'hi'</span>)</span><br><span class="line">readableStream.push(<span class="string">'ho'</span>)</span><br></pre></td></tr></table></figure>

<h5 id="向可写流写入数据"><a href="#向可写流写入数据" class="headerlink" title="向可写流写入数据"></a>向可写流写入数据</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">writableStream.write(<span class="string">'hey!\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结束</span></span><br><span class="line">writableStream.end()</span><br></pre></td></tr></table></figure>

<h3 id="nodejs开发环境和生产环境区别"><a href="#nodejs开发环境和生产环境区别" class="headerlink" title="nodejs开发环境和生产环境区别"></a>nodejs开发环境和生产环境区别</h3><p>可以为生产和开发环境使用不同的配置。</p>
<p>nodejs假定始终在开发环境中运行。可以通过设置NODE_ENV = production环境变量来向nodejs发出生产中运行的信号</p>
<p>使用命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export NODE_ENV = production</span><br></pre></td></tr></table></figure>

<p>设置生产环境通常可以确保</p>
<ul>
<li>日志记录保持在最低水平</li>
<li>发生更多的缓存级别以优化性能</li>
</ul>
<p>可以使用条件语句在不同环境下执行不同代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(process.env.NODE_ENV === <span class="string">"development"</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(process.env.NODE_ENV === <span class="string">"production"</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>([<span class="string">'production'</span>, <span class="string">'staging'</span>].indexOf(process.env.NODE_ENV) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>例如，在express应用中，可以使用它在每个环境中设置不同的错误处理程序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(process.env.NODE_ENV === <span class="string">"development"</span>) &#123;</span><br><span class="line">    app.use(express.errorHandler(&#123; <span class="attr">dumpExceptions</span>: <span class="literal">true</span>, <span class="attr">showStack</span>: <span class="literal">true</span> &#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">"production"</span>) &#123;</span><br><span class="line">  app.use(express.errorHandler())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="nodejs中错误处理"><a href="#nodejs中错误处理" class="headerlink" title="nodejs中错误处理"></a>nodejs中错误处理</h3><h5 id="creating-exception"><a href="#creating-exception" class="headerlink" title="creating exception"></a>creating exception</h5><p>通过throw关键字抛出异常</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> value</span><br></pre></td></tr></table></figure>

<p>JavaScript一旦执行throw，就会停止正常程序流，并将控件保留到最近的异常处理程序</p>
<p>通常在客户端代码中，value可以是任何JavaScript值，包括字符串、数字或对象</p>
<p>而在nodejs中，不抛出字符串，而只是抛出Error对象</p>
<h5 id="Error对象"><a href="#Error对象" class="headerlink" title="Error对象"></a>Error对象</h5><p>一个错误对象是Error对象的实例，或者是Error核心模块中提供的扩展Error类的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Ran  out of coffee'</span>)</span><br></pre></td></tr></table></figure>

<p>or</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> NotEnoughCoffeeError extends <span class="built_in">Error</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> NotEnoughCoffeeError()</span><br></pre></td></tr></table></figure>

<h5 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h5><p>使用try/catch语句处理异常。try中包含的代码引发任何异常都在相应的catch块中处理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h5 id="捕获未捕获的异常"><a href="#捕获未捕获的异常" class="headerlink" title="捕获未捕获的异常"></a>捕获未捕获的异常</h5><p>如果在程序执行过程中引发未捕获的异常，则程序将崩溃。解决此问题，侦听process对象上uncaughtException事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">process.on(<span class="string">'uncaughtException'</span>, err =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">'there was an uncaught error'</span>, err)</span><br><span class="line">    process.exit(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="promise的异常"><a href="#promise的异常" class="headerlink" title="promise的异常"></a>promise的异常</h5><p>使用promise可以链接不同的操作，并在最后处理错误</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">doSomthing1()</span><br><span class="line">  .then(doSomething2)</span><br><span class="line">  .then(doSomething3)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.error(err))</span><br></pre></td></tr></table></figure>

<p>我们不知道错误发生在哪里，但是可以处理调用的每个函数（doSomethingX）中的错误，并在错误处理程序内部抛出一个新错误，这将调用外部catch处理程序：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> doSomething1 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">//... handle it locally</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(err.message)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了可以在本地处理错误而不在调用的函数中处理错误，可以中断链，在每个then中创建一个函数处理异常</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">doSomething1()</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> doSomething2().catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> err  <span class="comment">// break the chain</span></span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> doSomething3().catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> err</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err))</span><br></pre></td></tr></table></figure>

<h5 id="async-await的错误处理"><a href="#async-await的错误处理" class="headerlink" title="async/await的错误处理"></a>async/await的错误处理</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> someOtherFunction()</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err.message)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="nodejs中如何记录对象"><a href="#nodejs中如何记录对象" class="headerlink" title="nodejs中如何记录对象"></a>nodejs中如何记录对象</h3><p>在控制台中打印console.log()时，在达到一定嵌套级别之前一切都好，但是经过两个级别的嵌套后，nodejs放弃，并打印[Object]作为占位符</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'joe'</span>,</span><br><span class="line">  age: <span class="number">35</span>,</span><br><span class="line">  person1: &#123;</span><br><span class="line">    name: <span class="string">'Tony'</span>,</span><br><span class="line">    age: <span class="number">50</span>,</span><br><span class="line">    person2: &#123;</span><br><span class="line">      name: <span class="string">'Albert'</span>,</span><br><span class="line">      age: <span class="number">21</span>,</span><br><span class="line">      person3: &#123;</span><br><span class="line">        name: <span class="string">'Peter'</span>,</span><br><span class="line">        age: <span class="number">23</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  name: <span class="string">'joe'</span>,</span><br><span class="line">  age: <span class="number">35</span>,</span><br><span class="line">  person1: &#123;</span><br><span class="line">    name: <span class="string">'Tony'</span>,</span><br><span class="line">    age: <span class="number">50</span>,</span><br><span class="line">    person2: &#123;</span><br><span class="line">      name: <span class="string">'Albert'</span>,</span><br><span class="line">      age: <span class="number">21</span>,</span><br><span class="line">      person3: [<span class="built_in">Object</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如何打印整个对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(obj, <span class="literal">null</span>, <span class="number">2</span>))  <span class="comment">// 2是用于缩进的空格数</span></span><br></pre></td></tr></table></figure>

<p>另一种：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'util'</span>).inspect.defaultOptions.depth = <span class="literal">null</span></span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/vue/MarkDown基本语法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/vue/MarkDown基本语法/" itemprop="url">MarkDown基本语法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Markdown是一种纯文本格式的标记语言。通过简单的标记语法，它可以使普通文本内容具有一定的格式。</p>
<h1 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在想要设置为标题的文字前面加#来表示</span><br><span class="line">一个#是一级标题，二个#是二级标题，以此类推。支持六级标题。</span><br></pre></td></tr></table></figure>

<h1 id="二、字体"><a href="#二、字体" class="headerlink" title="二、字体"></a>二、字体</h1><h2 id="加粗"><a href="#加粗" class="headerlink" title="加粗"></a>加粗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要加粗的文字左右分别用两个*号包起来</span><br></pre></td></tr></table></figure>

<h2 id="斜体"><a href="#斜体" class="headerlink" title="斜体"></a>斜体</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要倾斜的文字左右分别用一个*号包起来</span><br></pre></td></tr></table></figure>

<h2 id="斜体加粗"><a href="#斜体加粗" class="headerlink" title="斜体加粗"></a>斜体加粗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要倾斜和加粗的文字左右分别用三个*号包起来</span><br></pre></td></tr></table></figure>

<h2 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要加删除线的文字左右分别用两个~~号包起来</span><br></pre></td></tr></table></figure>

<h1 id="三、引用"><a href="#三、引用" class="headerlink" title="三、引用"></a>三、引用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在引用的文字前加&gt;即可。引用也可以嵌套，如加两个&gt;&gt;三个&gt;&gt;&gt;</span><br><span class="line">n个...</span><br><span class="line">貌似可以一直加下去，但没神马卵用</span><br></pre></td></tr></table></figure>

<h1 id="四、分割线"><a href="#四、分割线" class="headerlink" title="四、分割线"></a>四、分割线</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">三个或者三个以上的 - 或者 * 都可以</span><br></pre></td></tr></table></figure>

<h1 id="五、图片"><a href="#五、图片" class="headerlink" title="五、图片"></a>五、图片</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">    ![图片alt](图片地址 &apos;&apos;图片title&apos;&apos;)</span><br><span class="line"></span><br><span class="line">    图片alt就是显示在图片下面的文字，相当于对图片内容的解释。</span><br><span class="line">    图片title是图片的标题，当鼠标移到图片上时显示的内容。title可加可不加</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">示例：</span><br><span class="line">![blockchain](https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/</span><br><span class="line">u=702257389,1274025419&amp;fm=27&amp;gp=0.jpg &quot;区块链&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">上传本地图片直接点击导航栏的图片标志，选择图片即可</span><br></pre></td></tr></table></figure>

<h1 id="六、超链接"><a href="#六、超链接" class="headerlink" title="六、超链接"></a>六、超链接</h1><h3 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[超链接名](超链接地址 &quot;超链接title&quot;)</span><br><span class="line">title可加可不加</span><br></pre></td></tr></table></figure>

<h3 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[简书](http://jianshu.com)</span><br><span class="line">[百度](http://baidu.com)</span><br></pre></td></tr></table></figure>

<h1 id="七、列表"><a href="#七、列表" class="headerlink" title="七、列表"></a>七、列表</h1><h2 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">无序列表用 - + * 任何一种都可以</span><br><span class="line"></span><br><span class="line">- 列表内容</span><br><span class="line">+ 列表内容</span><br><span class="line">* 列表内容</span><br><span class="line"></span><br><span class="line">注意：- + * 跟内容之间都要有一个空格</span><br></pre></td></tr></table></figure>

<h2 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">数字加点</span><br><span class="line"></span><br><span class="line">1.列表内容</span><br><span class="line">2.列表内容</span><br><span class="line">3.列表内容</span><br><span class="line"></span><br><span class="line">注意：序号跟内容之间要有空格</span><br></pre></td></tr></table></figure>

<h2 id="列表嵌套"><a href="#列表嵌套" class="headerlink" title="列表嵌套"></a>列表嵌套</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">上一级和下一级之间敲三个空格即可</span><br></pre></td></tr></table></figure>

<h2 id="八、表格"><a href="#八、表格" class="headerlink" title="八、表格"></a>八、表格</h2><h3 id="语法：-1"><a href="#语法：-1" class="headerlink" title="语法："></a>语法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">表头|表头|表头</span><br><span class="line">---|:--:|---:</span><br><span class="line">内容|内容|内容</span><br><span class="line">内容|内容|内容</span><br><span class="line"></span><br><span class="line">第二行分割表头和内容。</span><br><span class="line">- 有一个就行，为了对齐，多加了几个</span><br><span class="line">文字默认居左</span><br><span class="line">-两边加：表示文字居中</span><br><span class="line">-右边加：表示文字居右</span><br><span class="line">注：原生的语法两边都要用 | 包起来。此处省略</span><br></pre></td></tr></table></figure>

<h3 id="示例：-1"><a href="#示例：-1" class="headerlink" title="示例："></a>示例：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">姓名|技能|排行</span><br><span class="line">--|:--:|--:</span><br><span class="line">刘备|哭|大哥</span><br><span class="line">关羽|打|二哥</span><br><span class="line">张飞|骂|三弟</span><br></pre></td></tr></table></figure>

<h2 id="九、代码"><a href="#九、代码" class="headerlink" title="九、代码"></a>九、代码</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p>单行代码：代码之间分别用一个反引号包起来<br>代码块：代码之间分别用三个反引号包起来，且两边的反引号单独占一行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注：为了防止转译，前后三个反引号处加了小括号，实际是没有的。这里只是用来演示，实际中去掉两边小括号即可。</span><br></pre></td></tr></table></figure>

<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>单行代码<br><code>create database hero;</code></p>
<p>代码块<br>(<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    function fun()&#123;</span><br><span class="line">         echo &quot;这是一句非常牛逼的代码&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    fun();</span><br><span class="line">(```)</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">//java代码段部分</span><br></pre></td></tr></table></figure></p>
<h2 id="十、流程图"><a href="#十、流程图" class="headerlink" title="十、流程图"></a>十、流程图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: 开始</span><br><span class="line">op=&gt;operation: My Operation</span><br><span class="line">cond=&gt;condition: Yes or No?</span><br><span class="line">e=&gt;end</span><br><span class="line">st-&gt;op-&gt;cond</span><br><span class="line">cond(yes)-&gt;e</span><br><span class="line">cond(no)-&gt;op</span><br><span class="line">&amp;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/vue/js中获取一个对象的属性和值的方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/vue/js中获取一个对象的属性和值的方法/" itemprop="url">js中获取一个对象的属性的方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="js中获取一个对象的属性的方法"><a href="#js中获取一个对象的属性的方法" class="headerlink" title="js中获取一个对象的属性的方法"></a>js中获取一个对象的属性的方法</h1><ol>
<li>获得属性值<br>对象内置属性方法:<strong>Object.keys()</strong>：该方法返回一个数组，数组内包括对象内可枚举属性以及方法名称。数组中属性名的排列顺序和使用 for…in 遍历该对象时返回的顺序一致。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 通过调用Object.keys()方法，获取对象上已定义(可枚举)的属性和方法</span><br><span class="line">var keys= Object.keys(Obj);</span><br><span class="line">　　console.log(keys); // 输出 keys [&quot;&quot;, &quot;&quot;, &quot;&quot;]属性列表</span><br><span class="line">　　</span><br><span class="line">console.log(Object.keys(chartData[0])[0]) //得到chartData数组第一个对象的第一个属性名</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>Object.getOwnPropertyNames():方法返回一个指定对象所有自身属性的属性名（包括不可枚举属性但不包括Symbol值作为名称的属性）组成的数组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var keys = Object.getOwnPropertyNames(Obj);</span><br><span class="line">　　console.log(keys);　　// 输出 keys [&quot;&quot;, &quot;&quot;, &quot;&quot;]属性列表</span><br></pre></td></tr></table></figure>

<p>除了以上两个外，还有最原始的 for…in 循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var keys =[];</span><br><span class="line">　　for(var i in Obj)&#123;</span><br><span class="line">    　　keys.push(i);</span><br><span class="line">　　&#125;</span><br><span class="line">　　console.log(keys);   // keys [&quot;&quot;, &quot;&quot;, &quot;&quot;]</span><br></pre></td></tr></table></figure>

<p>三者的区别：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">var testObj = Object.create(&#123;&#125;, &#123;</span><br><span class="line">    getFoo: &#123;</span><br><span class="line">        value: function () &#123;</span><br><span class="line">            return this.foo;</span><br><span class="line">        &#125;,</span><br><span class="line">        enumerable: false</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">testObj.name = &quot;shangguan&quot;;</span><br><span class="line">testObj.age = 25;</span><br><span class="line">testObj.action = function()&#123;</span><br><span class="line">  return this.name;</span><br><span class="line">&#125;;</span><br><span class="line">function getKeys() &#123;</span><br><span class="line">    // 获取对象可枚举和不可枚举的属性</span><br><span class="line">    console.log(Object.getOwnPropertyNames(testObj));   //输出:[&quot;getFoo&quot;, &quot;name&quot;, &quot;age&quot;, &quot;action&quot;]</span><br><span class="line">    // 获取对象可枚举的属性</span><br><span class="line">    console.log(Object.keys(testObj));  //输出:[&quot;name&quot;, &quot;age&quot;, &quot;action&quot;]</span><br><span class="line">    // 获取对象可枚举的属性</span><br><span class="line">    for (var i in testObj) &#123;</span><br><span class="line">        console.log(i);     //输出 name,age,action</span><br><span class="line">    &#125;</span><br><span class="line">    //返回直接定义在该对象上的可枚举属性，非继承。通过hasOwnProperty()方法可以将那些属性是对象自身(非继承)属性筛选出来，从而将不可枚举属性排除出去</span><br><span class="line">    //obj.hasOwnProperty(prop): prop要检测的属性,字符串 名称或者 Symbol。     返回值:用来判断某个对象是否含有指定的属性 的Boolean值</span><br><span class="line">    for (var i in testObj) &#123;</span><br><span class="line">        if(testObj.hasOwnProperty(i)) &#123;</span><br><span class="line">            console.log(i);</span><br><span class="line">        &#125;    //输出 name,age,action</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总结：如果只需要获取可枚举属性，那么Object.keys()或for…in循环迭代即可（Object.getOwnPropertyNames()也可以获取到原型链上的可枚举属性，不过需要通过hasOwnProperty()方法过滤掉不可枚举属性）。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/javascript/JavaScript中对象（Objects）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/javascript/JavaScript中对象（Objects）/" itemprop="url">JavaScript中对象（Objects）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JavaScript简单的数据类型包括数字、字符串、布尔值、null值和undefined值。其他所有值都是对象。数字、字符串、布尔值“貌似”对象，因为它们拥有方法，但是他们是不可变的。在JavaScript中，数组是对象、函数是对象、正则表达式是对象，对象也是对象。  </p>
<p>对象是属性的容器。属性包含属性名和值。属性名可以是包含空字符串在内的任意字符串，属性值可以是除了undefined之外的任何值。  </p>
<p>JavaScript对象是无类型的。对新属性的名字和属性的值没有限制。对象中可以包含其他对象，适合用于汇集和管理数据。  </p>
<p>JavaScript包含一种原型链的特性，允许对象继承另一个对象属性。正确使用可以减少对象初始化时消耗的时间和内存。</p>
<h4 id="对象字面量"><a href="#对象字面量" class="headerlink" title="对象字面量"></a>对象字面量</h4><p>对象字面量提供了非常方便创建新对象值的方法。对象字面量可出现在任何字面量可以出现的地方。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;&#125;;</span><br><span class="line">var obj2 = &#123;</span><br><span class="line">    &quot;first-name&quot; : &quot;zhangsan&quot;,</span><br><span class="line">    &quot;second-name&quot; : &quot;lisi&quot;</span><br><span class="line">&#125;</span><br><span class="line">var obj3 = &#123;</span><br><span class="line">    first_name : &quot;zhangsan&quot;,</span><br><span class="line">    second_name : &quot;lisi&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果属性名是一个合法的JavaScript标识符且不是保留字，并不强制要求用引号括住属性名</p>
<h4 id="检索"><a href="#检索" class="headerlink" title="检索"></a>检索</h4><p>要检索对象中包含的值，可以用在[]中括住一个字符串表达式的方式。如果字符串表达式是一个字符串字面量，而且是一个合法的字符串标识符且不是保留字，也可以用 . 表示法代替。推荐用 .</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj[name]</span><br><span class="line">obj.name</span><br></pre></td></tr></table></figure>

<p>如果检索一个不存在的值则会返回undefined。<br>||运算符可以用来填充默认值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var name = obj.name || &quot;zhangsan&quot;</span><br></pre></td></tr></table></figure>

<h4 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h4><p>对象中的值可以通过赋值语句进行更新。若属性名已经存在对象中，这个属性的值就会被替换。如果对象之前没有这个属性名，则属性就会被扩充到对象中。</p>
<h4 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h4><p>对象通过引用来传递，永远不会被复制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var x = y;</span><br><span class="line">x.name = &quot;zhangsan&quot;</span><br><span class="line">var yname = y.name  // 因为x和y是指向同一个对象的引用，所以yname也为zhangsan</span><br><span class="line"></span><br><span class="line">var a = &#123;&#125; , b = &#123;&#125; , c = &#123;&#125;; // a,b,c都引用一个不同的空对象</span><br><span class="line">var a = b = c = &#123;&#125;; // a,b,c都引用同一个空对象</span><br></pre></td></tr></table></figure>

<h4 id="原型（prototype）"><a href="#原型（prototype）" class="headerlink" title="原型（prototype）"></a>原型（prototype）</h4><p>每个对象都连接到一个原型对象，并且可以从中继承属性。所有通过字面量创建的对象都连接到Object.prototype，它是JavaScript中的标配对象。  </p>
<p>当创建一个对象时，可以选择某个对象作为它的原型。可以使用Object.create()方法<br>(可以参考一些new创建和Object.create()创建方法的区别)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// new Object() 方式创建</span><br><span class="line">var a = &#123;</span><br><span class="line">    name: &apos;zhangsan&apos;,</span><br><span class="line">    age: 25</span><br><span class="line">&#125;</span><br><span class="line">var b = new Object(a)</span><br><span class="line">console.log(b) // &#123; name: &apos;zhangsan&apos;, age: 25 &#125;</span><br><span class="line">console.log(b.__proto__) // &#123;&#125;</span><br><span class="line">console.log(b.name) // zhangsan</span><br><span class="line"></span><br><span class="line">// Object.create() 方式创建</span><br><span class="line">var a = &#123;</span><br><span class="line">    name: &apos;zhangsan&apos;,</span><br><span class="line">    age: 25</span><br><span class="line">&#125;</span><br><span class="line">var b = Object.create(a)</span><br><span class="line">console.log(b) // &#123;&#125;</span><br><span class="line">console.log(b.__proto__) // &#123; name: &apos;zhangsan&apos;, age: 25 &#125;</span><br><span class="line">console.log(b.name) // zhangsan</span><br></pre></td></tr></table></figure>

<p>原型连接在更新时是不起作用的。当对某个对象作出改变时，不会触及该对象的原型。<br>原型连接只在检索值的时候才被用到。当我们尝试去获取对象的某个属性值时，如果该对象没有这个属性名，则JavaScript会试着从原型对象中获取属性值。如果那个对象也没有该属性值，再继续从他的原型中找，知道最后达到终点Object.prototype。如果想要的属性完全不存在于原型链中，则结果为undefined。  </p>
<p>原型关系是一种动态关系。即如果加一个新属性到原型中，该属性会立即对所有基于该原型创建的对象可见。  </p>
<h4 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h4><p>检查对象并确定对象有什么属性可以使用typeof操作符。<br>注意，原型链中任何属性都会产生值，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">typeof flight.toString  // &apos;function&apos;</span><br><span class="line">typeof flight.constructor  // &apos;function&apos;</span><br></pre></td></tr></table></figure>

<p>有两种方法处理这些不需要的属性。第一个是让程序做检查并丢弃值为函数的属性。一般来说，当想让对象在运行时动态获取自身信息时，关注更多的是数据，应该意识到一些值可能会是函数。另一个方法是hasOwnProperty方法。如果对象拥有独有的属性，返回true。hasOwnProperty方法并不会检查原型链。</p>
<h4 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h4><p>for in语句可用来遍历对象中所有属性名（包括函数和原型中的属性），所以有必要过滤不想要的值。最为常用的过滤器是hasOwnProperty方法，以及使用typeof来排除函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var name;</span><br><span class="line">for(name in obj) &#123;</span><br><span class="line">    if (typeof obj[name] !== &apos;function&apos;) &#123;</span><br><span class="line">        // 处理语句</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样属性名出现的顺序是不确定的。如果想要确保属性按特定顺序出现，则需要避免使用for in语句，而是创造一个数组，以正确的顺序包含属性名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var i;</span><br><span class="line">var properties = &#123;</span><br><span class="line">    &apos;first_name&apos;,</span><br><span class="line">    &apos;middle_name&apos;,</span><br><span class="line">    &apos;last_name&apos;</span><br><span class="line">&#125;;</span><br><span class="line">for (i = 0; i &lt; properties.length; i++) &#123;</span><br><span class="line">    console.log(properties[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过使用for可以得到我们想要的属性，而不用担心可能发掘出的原型链中的属性，且可以按正确顺序取值。</p>
<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><p>delete运算符可以用来删除对象的属性。如果对象包含该属性，则该属性会被移除。不会触及原型链中任何对象。</p>
<h4 id="减少全局变量污染"><a href="#减少全局变量污染" class="headerlink" title="减少全局变量污染"></a>减少全局变量污染</h4><p>JavaScript可以很随意的定义全局变量来容纳应用的所有资源。但是，全局变量削弱了程序的灵活性，应该避免使用。<br>最小化使用全局变量方法之一是为应用只创建一个唯一的全局变量。<br>只要把全局性资源都纳入一个名称空间下，程序与其他应用程序、组件或类库之间发生冲突的可能性会显著降低。还有一种是利用闭包进行信息隐藏，是另一种有效的减少全局污染方式。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/javascript/JavaScript中函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/javascript/JavaScript中函数/" itemprop="url">JavaScript中函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JavaScript设计最出色的就是它的函数实现。<br>函数包含一组语句，是JavaScript的基础模块单元，用于代码复用、信息隐藏和组合调用。一般来说，编程就是将一组需求分解成一组函数与数据结构的技能。<br>重点关注this参数</p>
<h4 id="函数对象"><a href="#函数对象" class="headerlink" title="函数对象"></a>函数对象</h4><p>JavaScript中函数就是对象。对象字面量产生的对象连接到Object.prototype。函数对象连接到Function.prototype（该原型对象本身连接到Object.prototype）。每个函数创建时会附加两个隐藏属性：函数的上下文和实现函数行为的代码。（JavaScript创建一个函数对象时，会给对象设置一个“调用”属性。当调用一个函数时，可理解调用此函数的“调用”属性）  </p>
<p>每个函数在创建时也随配有一个prototype属性。他的值是一个拥有constructor属性且值即为该函数的对象。  </p>
<p>因为函数是对象，所以他们可以向任何其他值一样被使用。函数可以保存在变量、对象和数组中。函数可以被当作参数传递给其他函数，函数也可以再返回函数。而且，因为函数是对象，所以函数也可以拥有方法。  </p>
<p>函数的与众不同在于他们可以被调用。</p>
<h4 id="函数字面量"><a href="#函数字面量" class="headerlink" title="函数字面量"></a>函数字面量</h4><p>函数对象通过函数字面量来创建：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 创建一个add变量，并用来把两个数字相加的函数赋值给他</span><br><span class="line">var add = function (a, b) &#123;</span><br><span class="line">    return a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数字面量包含4个部分：</p>
<ol>
<li>保留字function</li>
<li>函数名，可省略。如果没有函数名，则被称为匿名函数。</li>
<li>参数。参数的名称被定义为函数中的变量。不像普通变量被初始化为undefined，而是函数调用时初始化实际提供的参数值</li>
<li>包围在花括号中的一组语句。函数的主体，调用时执行。</li>
</ol>
<p>一个内部函数除了可访问自己参数和变量，同时也能自由访问把它嵌套其中的父函数的参数和变量</p>
<h4 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h4><p>调用一个函数会暂停当前函数的执行，传递控制权和参数给新函数。除了声明时定义的形参，每个函数还接受两个附加参数：this和argument。  </p>
<p>调用运算符是跟在任何一个函数值的表达式之后的一对圆括号。圆括号内可包含零个或多个用逗号隔开的表达式，每个表达式产生一个参数值，每个参数值被赋予函数声明时定义的形式参数名。<strong>当实际参数个数与形参个数不匹配时，不会导致运行时的错误</strong>。如果实际参数值过多了，超出的会被省略；如果实际参数少了，缺失的值会被替换为undefined。<strong>对参数值不会进行类型检查</strong>：任何类型的值都可以被传递给任何参数。</p>
<h4 id="JavaScript中的调用模式"><a href="#JavaScript中的调用模式" class="headerlink" title="==JavaScript中的调用模式=="></a>==JavaScript中的调用模式==</h4><p>函数中有参数this，this在面向对象编程中是非常重要的，他的值取决调用的模式。JavaScript中一共有4种调用的模式：方法调用模式、函数调用模式、构造器调用模式、apply调用模式。这些模式再如何初始化this上存在差异。</p>
<h5 id="方法调用模式"><a href="#方法调用模式" class="headerlink" title="方法调用模式"></a>方法调用模式</h5><p>当一个函数被保存为对象的一个属性时，称之为方法。当方法被调用时，this被绑定到该对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 创建一个obj对象，有一个value属性和一个increment方法</span><br><span class="line">// increment接受一个可选参数。如果参数不是数字，那么默认使用数字1</span><br><span class="line"></span><br><span class="line">var obj = &#123;</span><br><span class="line">    value: 0,</span><br><span class="line">    increment: function(inc) &#123;</span><br><span class="line">        this.value += typeof inc === &apos;number&apos; ? inc : 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.increment();</span><br><span class="line">document.writeln(obj.value); // 1</span><br><span class="line">obj.increment(2)</span><br><span class="line">document.writeln(obj.value); // 3</span><br></pre></td></tr></table></figure>

<p>方法this可以访问自己所属的对象，可从对象中取值或者对对象进行修改。this到对象的绑定发生在调用的时候。这个“超级”延迟绑定使得函数可以对this高度复用。通过this可取得所属对象上下文的方法称为公共方法。</p>
<h5 id="函数调用模式"><a href="#函数调用模式" class="headerlink" title="函数调用模式"></a>函数调用模式</h5><p>当一个函数并非一个对象的属性时，它是被当做一个函数来调用的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var sum = add(3, 4)</span><br></pre></td></tr></table></figure>

<p>在这个模式下调用函数时，this绑定的是全局变量。这是语言设计上的一个错误。如果设计正确的话，那么内部函数被调用的时候，this应该仍然绑定到他外部函数的this变量。这个错误的后果是方法不能利用内部函数来帮它工作，因为内部函数的this绑定了错误的值，不能共享该方法对对象的访问权。当然也有解决方案，就是通过定义一个变量，把this赋值给它。那么内部函数就可以通过这个变量访问到this。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 给obj添加一个double方法</span><br><span class="line">obj.double = function() &#123;</span><br><span class="line">    var _this = this;</span><br><span class="line">    var fun = function() &#123;</span><br><span class="line">        _this.value = add(_this.value, _this.value)</span><br><span class="line">    &#125;</span><br><span class="line">    fun();</span><br><span class="line">&#125;</span><br><span class="line">// 以方法的形式调用double</span><br><span class="line">obj.double();</span><br><span class="line">document.writeln(obj.value)</span><br></pre></td></tr></table></figure>

<h5 id="构造器调用模式"><a href="#构造器调用模式" class="headerlink" title="构造器调用模式"></a>构造器调用模式</h5><p>如果一个函数前面带上new来调用，那么背地里将会创建一个连接到该函数的prototype成员的新对象，同时this会被绑定到新对象上。  </p>
<p>new前缀也会改变return语句的行为。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 创建一个名为Quo的构造器函数。构造一个带有status属性的对象</span><br><span class="line">var Quo = function(string) &#123;</span><br><span class="line">    this.status = string</span><br><span class="line">&#125;;</span><br><span class="line">// 给Quo所有实例提供一个名为get_status的公共方法</span><br><span class="line">Quo.prototype.get_status = function() &#123;</span><br><span class="line">    return this.status;</span><br><span class="line">&#125;;</span><br><span class="line">// 构造一个Quo实例</span><br><span class="line">var myQuo = new Quo(&quot;confused&quot;);</span><br><span class="line">document.writeln(myQuo.get_status()); // 打印显示“confused”</span><br></pre></td></tr></table></figure>

<p><strong>一个函数如果创建的目的是希望结合new前缀来调用，那么就被称为构造器函数</strong>。按照约定，他们保存在以大写格式命名的变量里。如果构造器函数前没有加new，可能会发生很糟糕的事，既没有编译时警告，也没有运行时警告。所以大写约定很重要。</p>
<h5 id="Apply调用模式-不是太理解"><a href="#Apply调用模式-不是太理解" class="headerlink" title="Apply调用模式(不是太理解)"></a>Apply调用模式(不是太理解)</h5><p>因为JavaScript是函数式的面向对象的编程语言，所以函数可以拥有方法。  </p>
<p>apply方法让我们构建一个参数数组传递给调用函数。它也允许我们选择this的值。apply方法接收两个参数，第一个是要绑定给this的值，第二个就是一个参数数组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 构造一个包含两个数字的数组，并将他们相加</span><br><span class="line">var array = [3, 4]</span><br><span class="line">var sum = add.apply(null, array)</span><br><span class="line"></span><br><span class="line">// 构造一个包含status成员的对象</span><br><span class="line">var statusObj = &#123;</span><br><span class="line">    status: &apos;ok&apos;</span><br><span class="line">&#125;</span><br><span class="line">// statusObj没有继承Quo.prototype，但我们可以在statusObj上调用get_status方法，尽管statusObj上没有get_status方法</span><br><span class="line">var status = Quo.prototype.get_status.apply(statusObj)</span><br></pre></td></tr></table></figure>

<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><p>当函数被调用时会有一个附带的参数arguments数组。函数可以通过这个参数访问所有他被调用时传递给他的参数列表，包括那些函数没有分配给函数声明时定义的形式参数的多余参数。这使得编写一个无须指定参数个数的函数成为可能。  </p>
<p>因为语言的一个设计错误，arguments并不是一个真正的数组。只是一个“类似数组”的对象。arguments拥有一个length属性，但是它没有任何数组的方法。</p>
<h4 id="返回"><a href="#返回" class="headerlink" title="返回"></a>返回</h4><p>return语句可使函数提前返回。<br>一个函数总是会返回一个值，如果没有指定返回值，则返回undefined。<br>如果函数调用时在前面加上了new前缀，且返回值不是一个对象，则返回this（该新对象）</p>
<h4 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h4><p>JavaScript提供一套异常处理机制。异常是干扰程序正常流程的不寻常（但并非是完全出乎意料）的事故。当发生这样的事故时，程序应该抛出一个异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var add = function(a, b) &#123;</span><br><span class="line">    if (typeof a !== &apos;number&apos; || typeof b !== &apos;number&apos;) &#123;</span><br><span class="line">        throw &#123;</span><br><span class="line">            name: &apos;TypeError&apos;,</span><br><span class="line">            message: &apos;add needs numbers&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>throw语句中断函数的执行，它应该抛出一个exception对象，该对象包含异常类型的name属性和一个描述的message属性。当然也可以添加其他属性。  </p>
<p>该exception对象被传递到一个try语句的catch从句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 构造一个try_it函数，以不正确的方式调用之前的add函数</span><br><span class="line">var try_it = function() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        add(&apos;seven&apos;)</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        document.writeln(e.name + &apos;: &apos; + e.message)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">try_it()</span><br></pre></td></tr></table></figure>

<p>如果在try代码块内抛出一个异常，则控制权会跳转到catch从句。<br>一个try语句只会有一个捕获异常的catch代码块。如果处理手段取决于异常的类型，则异常处理器必须检查异常对象的name属性来确定异常的类型。</p>
<h4 id="扩充类型的功能"><a href="#扩充类型的功能" class="headerlink" title="扩充类型的功能"></a>扩充类型的功能</h4><p>JavaScript允许给语言基本类型的扩充功能.对于对象我们可以通过Object.prototype添加方法，可以让该方法对所有对象都可用。这种方式同样适用函数、数组、字符串、数字、正则表达式和布尔值。  </p>
<p>可以通过Function.prototype增加方法来使所有函数可用。  </p>
<p>JavaScript没有专门的整数类型。可通过Number.prototype增加一个integer方法来改善。会根据数字正负来判断是用Math.ceiling还是Math.floor。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Number.method(&apos;integer&apos;, function() &#123;</span><br><span class="line">    return Math[this &lt; 0 ? &apos;ceil&apos; : &apos;floor&apos;](this)</span><br><span class="line">&#125;);</span><br><span class="line">document.writeln((-10/3).integer()); // -3</span><br></pre></td></tr></table></figure>

<p>通过给基本类型增加方法，极大地提高了语言的表现力。因为JavaScript原型继承的动态本质，新方法立刻被赋予到所有对象实例上，哪怕对象在方法被增加之前已经创建。  </p>
<p>基本类型的原型是公用的结构，所以类库混用时要小心。</p>
<h4 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h4><p>递归函数就是会直接或间接调用自身的一种函数。把一个问题分解成一组相似的子问题，每一个都用一个寻常解去解决。<br>递归函数可以非常高效的操作树形结构，比如浏览器端的文档对象模型（DOM）,每次递归调用时处理指定的树的一小段。<br>一些语言提供了尾递归优化（尾递归是一种在函数的最后执行递归调用语句的特殊形式的递归）。这意味着如果一个函数返回自身递归调用的结果，那么调用过程会被替换为一个循环，可以显著提高速度。而JavaScript当前没有提供尾递归优化。深度递归的函数可能会因为对战溢出而运行失败。</p>
<h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><p>在编程语言中，作用域控制着变量与参数的可见性和生命周期。<br>大多数类C语言语法的语言都拥有块级作用域。但是，<strong>尽管JavaScript的代码块语法貌似支持块级作用域，但实际上JavaScript并不支持</strong>。  </p>
<p>JavaScript缺失有函数作用域。那意味着定义在函数中的参数和变量在函数外部是不可见的。而==在函数内部任何位置定义的变量，在该函数内部任何地方都是可见的==。  </p>
<p>现在很多语言都推荐尽可能延迟声明变量。而在JavaScript中不适合，因为它缺少块级作用域。所以最好的方法是在函数体的顶部声明函数中可能用到的所有变量。</p>
<h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><p>作用域的好处是内部函数可以访问定义他们的外部函数的参数和变量（除了this和arguments）。<br>之前构造过一个obj对象，它拥有一个value属性和一个increment方法。假定希望保护该值不被非法修改。和以对象字面量形式初始化不同，通过调用函数的形式初始化obj。函数会返回一个对象字面量。函数中定义一个value变量。变量对于increment和getValue方法总是可见的，但函数的作用域使得它对其他的程序是不可见的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var obj = (function() &#123;</span><br><span class="line">    var value = 0;</span><br><span class="line">    </span><br><span class="line">    return &#123;</span><br><span class="line">        increment: function(inc) &#123;</span><br><span class="line">            valur += typeof inc === &apos;number&apos; ? inc : 1;</span><br><span class="line">        &#125;,</span><br><span class="line">        getValue: function() &#123;</span><br><span class="line">            return value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure>

<p>这不是将一个函数赋值给obj，而==是将函数调用的结果赋值给他。注意最后一行的()==。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 创建一个名为quo的构造函数</span><br><span class="line">// 构造带有get_status方法和status私有属性的一个对象</span><br><span class="line">var quo = function(status) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        get_status: function() &#123;</span><br><span class="line">            return status</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 构造一个quo实例</span><br><span class="line">var myQuo = quo(&quot;amazed&quot;);</span><br><span class="line">document.writeln(myQuo.get_status());</span><br></pre></td></tr></table></figure>

<p>这个quo函数被设计成无须在前面加上new来使用，所以名字也没有首字母大写。当调用quo时，返回一个包含get_status方法的一个新对象。该对象的一个引用保存在myQuo中。即使quo已经返回了，但get_status方法仍然享有访问quo对象status属性的特权。get_status方法并不是访问该参数的一个副本，访问的是参数本身。因为该函数可以访问他被创建时的上下文环境。这被称为闭包。  </p>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 定义一个函数，设置DOM节点为黄色，然后把它渐变为白色</span><br><span class="line">var fade = function(node) &#123;</span><br><span class="line">    var level = 1;</span><br><span class="line">    var step = function() &#123;</span><br><span class="line">        var hex = level.toString(16);</span><br><span class="line">        node.style.backgroundColor = &apos;#FFFF&apos; + hex + hex</span><br><span class="line">        if (level &lt; 15) &#123;</span><br><span class="line">            level += 1;</span><br><span class="line">            setTimeout(level, 100);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    setTimeout(step, 100);</span><br><span class="line">&#125;;</span><br><span class="line">fade(document.body);</span><br></pre></td></tr></table></figure>

<p>调用fade，把document.body作为参数传递。fade函数定义一个level变量和一个step函数，接着调用setTimeout。然后返回，fade函数结束。  </p>
<p>100ms之后，step函数被调用。将fade函数level变量转化为16位字符。接着，修改fade函数得到的节点的背景颜色。然后查看level变量，如果背景色没有到白色，则level增1，接着使用setTimeout继续执行。  </p>
<p>==避免在循环中创建函数，他可能只会到来无谓的计算，还会引起混淆==。可以先在循环之外创建一个辅助函数，让这个辅助函数再返回一个绑定当前i值的函数。</p>
<h4 id="回调"><a href="#回调" class="headerlink" title="回调"></a>回调</h4><p>函数使得对不连续的事件处理变的容易。<br>网络上的同步请求会导致客户端进入假死状态。如果网络传输或服务器很慢，响应会慢的让人难以接受。更好的方式是发起异步请求，提供一个当服务器的响应到达时随即触发的回调函数。异步函数立即返回，这样客户端就不会阻塞。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">request = handleRequest();</span><br><span class="line">send_request(request, function(response) &#123;</span><br><span class="line">    display(response)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>传递一个函数作为参数给send_request函数，一旦收到响应就会被调用。</p>
<h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><p>可以使用函数和闭包来构造模块。模块是一个提供接口却隐藏状态与实现的函数或对象。通过使用函数产生模块，几乎可以完全摒弃全局变量的使用，从而缓解这个JavaScript最糟糕的特性之一带来的影响。  </p>
<p>模块模式利用了函数作用域和闭包来创建被绑定对象和私有成员的关联。  </p>
<p>模块模式的一般形式是：一个定义了私有变量和函数的函数；利用闭包创建可以访问私有变量和函数的函数；最后返回这个特权函数，或者把它保存到可以访问到的地方。  </p>
<p>使用模块模式可以完全摒弃全局变量的使用。促进信息隐藏和其他优秀设计实践。对于应用程序的封装，或者构造其他单例对象，模块模式非常有效。</p>
<h4 id="级联"><a href="#级联" class="headerlink" title="级联"></a>级联</h4><p>有一些方法没有返回值。例如，一些设置或修改对象的某个状态却不返回任何值的方法。如果让这些方法返回this而非undefined，就可以启用级联。在一个级联中，我们可以在单独一条语句中依次调用同一个对象的很多方法。  </p>
<p>级联技术可以产生极富表现力的接口。使得一个接口不必要依次做太多的事。</p>
<h4 id="柯里化（局部套用）"><a href="#柯里化（局部套用）" class="headerlink" title="柯里化（局部套用）"></a>柯里化（局部套用）</h4><p>这篇博客详细介绍了柯里化<br><a href="https://www.jianshu.com/p/2975c25e4d71" target="_blank" rel="noopener">https://www.jianshu.com/p/2975c25e4d71</a>  </p>
<p>将多参函数转化为一系列单参数函数并进行调用的技术。<br>柯里化允许我们把函数与传递给他的参数相结合，产生一个新的函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 普通的add函数</span><br><span class="line">function add(x, y) &#123;</span><br><span class="line">    return x + y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Currying后</span><br><span class="line">function curryingAdd(x) &#123;</span><br><span class="line">    return function (y) &#123;</span><br><span class="line">        return x + y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add(1, 2) // 3</span><br><span class="line">curryingAdd(1)(2) // 3</span><br></pre></td></tr></table></figure>

<p>即只传递给函数一部分参数来调用它，让它返回一个函数去处理剩下的参数</p>
<h4 id="记忆"><a href="#记忆" class="headerlink" title="记忆"></a>记忆</h4><p>让函数记住处理过的参数和处理结果。<br>函数可将先前操作的结果记录在某个对象中，从而==避免无谓的重复计算==。这种优化被称为记忆。<br>当输入的参数不变时，我们就可以采用缓存的结果，当输入参数有所变化时才重新计算。  </p>
<p>思想：通过闭包来缓存计算参数以及结果，通过参数的变化与否来决定是否重新计算。  </p>
<p>什么时候使用：只要一个函数可能反复计算相同的数据时。  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/web全栈/HTML5特性/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/web全栈/HTML5特性/" itemprop="url">HTML5特性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web全栈/" itemprop="url" rel="index">
                    <span itemprop="name">web全栈</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>HTML5：</p>
<ol>
<li>geolocation:定位</li>
<li>video、audio</li>
<li>localStorage: 存东西的。类似cookie<ul>
<li>cookie：特别小(4K)、浏览器和服务器共享</li>
<li>localStorage：大(5M)、浏览器独享</li>
</ul>
</li>
<li>*WebWorker：web端实现多进程的工作模式</li>
<li>WebSQL、IndexedDB：存在很大安全隐患（W3C已经删掉）</li>
<li>文件操作、文件拖拽</li>
<li>canvas：画图</li>
<li>manifest文件：前台控制缓存</li>
</ol>
<h3 id="geolocation"><a href="#geolocation" class="headerlink" title="geolocation"></a>geolocation</h3><ol>
<li>原理</li>
</ol>
<ul>
<li>PC端：通过IP地址定位，精度非常差</li>
<li>移动端：通过GPS定位，精度很高</li>
</ul>
<ol start="2">
<li>PC端<br>IP地址使用IP库；而Chrome浏览器寻找google.com获取，所以资源获取受限；使用IE浏览器，访问microsoft.com</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.navigator.geolocation</span><br></pre></td></tr></table></figure>

<ul>
<li>getCurrentPosition：获取位置（1次）</li>
<li>watchPosition：不断获取位置</li>
<li>clearWatch：关闭</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> oBtnlocation = <span class="built_in">document</span>.getElementById(<span class="string">'btn_location'</span>);</span><br><span class="line"></span><br><span class="line">  oBtnlocation.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// getCurrentPosition(成功，失败，参数)</span></span><br><span class="line">    <span class="built_in">window</span>.navigator.geolocation.getCurrentPosition(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(res.coords);</span><br><span class="line">      alert(<span class="string">'成功'</span>);</span><br><span class="line">    &#125;, err =&gt; &#123;</span><br><span class="line">      alert(<span class="string">'失败'</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h3><ol>
<li>域名、跨域</li>
<li>极其方便</li>
<li>用途:记录用户名、保存草稿</li>
</ol>
<ul>
<li>localStorage：永久存储</li>
<li>sessionlocalStorage：会话期间存储，浏览器关闭就没有</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存</span></span><br><span class="line">localStorage.a = <span class="number">12</span>;</span><br><span class="line">localStorage.b = <span class="number">8</span>;</span><br><span class="line">localStorage.c = <span class="number">88</span>;</span><br><span class="line"><span class="comment">// 取</span></span><br><span class="line">alert(localStorage.a);</span><br><span class="line"><span class="comment">// 遍历</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> name <span class="keyword">in</span> localStorage) &#123;</span><br><span class="line">  alert(<span class="string">`<span class="subst">$&#123;name&#125;</span>: <span class="subst">$&#123;localStorage[name]&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 官方推荐遍历方法</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;localStorage.length; i++) &#123;</span><br><span class="line">  <span class="comment">// alert(localStorage.key(i));</span></span><br><span class="line">  <span class="keyword">let</span> key = localStorage.key(i);</span><br><span class="line">  <span class="keyword">let</span> value = localStorage[key];</span><br><span class="line"></span><br><span class="line">  alert(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;localStorage[key]&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 删</span></span><br><span class="line"><span class="keyword">delete</span> localStorage.a;</span><br></pre></td></tr></table></figure>

<p>保存草稿</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> oTxt = <span class="built_in">document</span>.getElementById(<span class="string">'txt1'</span>);</span><br><span class="line">  <span class="keyword">let</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">'btn1'</span>);</span><br><span class="line">  oTxt.value = localStorage.tmp_txt || <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">  oTxt.oninput = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    localStorage.tmp_txt = oTxt.value;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  oBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'发送成功'</span>);</span><br><span class="line">    <span class="keyword">delete</span> localStorage.tmp_txt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WebWorker"><a href="#WebWorker" class="headerlink" title="WebWorker"></a>WebWorker</h3><p>web端多进程，用途很少。多进程主要充分发挥计算机CPU的资源，前端基本没用<br>主进程——UI进程<br>子进程——工作进程  </p>
<p>webworker</p>
<ol>
<li>不能控制UI的东西，可以做一些数据交互</li>
<li>子进程不能再创建子进程</li>
<li>跨域</li>
</ol>
<p>例：<br>主进程：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oW = <span class="keyword">new</span> Worker(<span class="string">'1.js'</span>); <span class="comment">// 1.js子进程</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// oW.postMessage(12);</span></span><br><span class="line">oW.postMessage(&#123;<span class="attr">a</span>: <span class="number">12</span>, <span class="attr">b</span>:<span class="number">24</span>&#125;);</span><br><span class="line">oW.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">  alert(ev.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>子进程：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(ev);</span><br><span class="line">  <span class="keyword">let</span> &#123;a, b&#125; = ev.data;</span><br><span class="line">  <span class="keyword">let</span> result = a + b;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.postMessage(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="画图：canvas、svg、vml"><a href="#画图：canvas、svg、vml" class="headerlink" title="画图：canvas、svg、vml"></a>画图：canvas、svg、vml</h3><p>画图</p>
<ul>
<li>canvas：位图——放大失真  HTML5标准</li>
<li>SVG：矢量图——无限缩放   不是HTML5东西，是一个独立标准</li>
<li>VML：矢量图  IE的矢量图</li>
</ul>
<h4 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h4><ol>
<li>路径操作：<ul>
<li>相当于选区——没有效果，还需后续操作</li>
<li>闭合一定要使用closePath</li>
</ul>
</li>
<li>边线：stroke()</li>
<li>填充：fill()</li>
<li>线宽：lineWidth</li>
<li>线的颜色：strokeStyle</li>
<li>填充颜色：fillStyle</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> oC = <span class="built_in">document</span>.getElementById(<span class="string">'c1'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 路径操作——类似PS的选区</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 图形上下文——接口：所有绘图方法、属性</span></span><br><span class="line">  <span class="keyword">let</span> gd = oC.getContext(<span class="string">'2d'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 起点</span></span><br><span class="line">  gd.moveTo(<span class="number">470</span>, <span class="number">81</span>);</span><br><span class="line">  gd.lineTo(<span class="number">778</span>, <span class="number">236</span>);</span><br><span class="line">  gd.lineTo(<span class="number">532</span>, <span class="number">411</span>);</span><br><span class="line">  gd.lineTo(<span class="number">312</span>, <span class="number">259</span>);</span><br><span class="line">  <span class="comment">// gd.lineTo(470, 81);  // gd.closePath()</span></span><br><span class="line">  gd.closePath();</span><br><span class="line"></span><br><span class="line">  gd.stroke();</span><br><span class="line">  gd.strokeStyle = <span class="string">'green'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// gd.fillStyle = 'yellow';</span></span><br><span class="line">  <span class="comment">// gd.full();</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>应用：</p>
<ol>
<li>图表——echarts</li>
<li>游戏</li>
<li>滤镜</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/vue/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/vue/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/web全栈/ES6相关笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/web全栈/ES6相关笔记/" itemprop="url">ES6相关笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web全栈/" itemprop="url" rel="index">
                    <span itemprop="name">web全栈</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ES"><a href="#ES" class="headerlink" title="ES"></a>ES</h2><p>ECMAScript(ECMA,ES)：一种标准<br>JavaScript是ECMA的一种。  </p>
<hr>
<p>ES6新语法：</p>
<ol>
<li>变量</li>
<li>函数</li>
<li>数组/json</li>
<li>字符串</li>
<li>面向对象</li>
<li>Promise</li>
<li>generator</li>
<li>模块</li>
</ol>
<hr>
<h3 id="一、变量"><a href="#一、变量" class="headerlink" title="一、变量"></a>一、变量</h3><p>var：可重复定义，不能限制修改，没有块级作用域。  </p>
<p>ES6引入let、const：不能重复定义；let是变量，const是常量；  </p>
<p>解构赋值：</p>
<ol>
<li>左右两边必须一样，右边是合法的内容</li>
<li>赋值和定义必须同步完成。</li>
</ol>
<h3 id="二、函数"><a href="#二、函数" class="headerlink" title="二、函数"></a>二、函数</h3><h4 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h4><p>==箭头函数，内外this不变==</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params">参数, 参数</span>)</span>&#123;</span><br><span class="line">    函数体</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 箭头函数</span></span><br><span class="line">(参数， 参数) =&gt; &#123;</span><br><span class="line">    函数体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>如果有且仅有1个参数，()可以省略。</li>
<li>如果函数体只有一句话，且是return，则{}可以省略。</li>
</ol>
<h4 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h4><p>(a, b = XXX, c = XX)</p>
<h4 id="参数展开（剩余参数、可变参数）"><a href="#参数展开（剩余参数、可变参数）" class="headerlink" title="参数展开（剩余参数、可变参数）"></a>参数展开（剩余参数、可变参数）</h4><ol>
<li>“…”的第一个作用：结构剩余参数<br>(a, b, …args): 用args接收剩下的所有参数</li>
<li>“…”的第二个作用：用来展开一个数组</li>
</ol>
<h3 id="三、数组和json"><a href="#三、数组和json" class="headerlink" title="三、数组和json"></a>三、数组和json</h3><h4 id="数组新增"><a href="#数组新增" class="headerlink" title="数组新增"></a>数组新增</h4><p>map、reduce、filter、forEach、Array</p>
<h5 id="map"><a href="#map" class="headerlink" title="map"></a>map</h5><p>映射：一一对应<br>[1, 2, 3, 4] =&gt; [false, true, false, true]</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">12</span>, <span class="number">65</span>, <span class="number">58</span>, <span class="number">39</span>, <span class="number">87</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr2 = arr.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (item &gt;= <span class="number">60</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用箭头函数</span></span><br><span class="line"><span class="keyword">let</span> arr3 = arr.map(<span class="function"><span class="params">item</span> =&gt;</span> item&gt;=<span class="number">60</span>);</span><br></pre></td></tr></table></figure>

<h5 id="reduce-汇总"><a href="#reduce-汇总" class="headerlink" title="reduce(汇总)"></a>reduce(汇总)</h5><p>一堆 -&gt; 一个</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 求平均值的功能</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">12</span>, <span class="number">65</span>, <span class="number">58</span>, <span class="number">39</span>, <span class="number">87</span>];</span><br><span class="line"></span><br><span class="line">arr.reduce(<span class="function">(<span class="params">tmp, item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(temp, item, index)</span><br><span class="line">    <span class="keyword">if</span> (index &lt; arr.length - <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> tmp + item;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (tmp + item) / arr.length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="filter-过滤"><a href="#filter-过滤" class="headerlink" title="filter(过滤)"></a>filter(过滤)</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">12</span>, <span class="number">65</span>, <span class="number">58</span>, <span class="number">39</span>, <span class="number">87</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr2 = arr.map(<span class="function"><span class="params">item</span> =&gt;</span> item % <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h5 id="forEach-遍历"><a href="#forEach-遍历" class="headerlink" title="forEach(遍历)"></a>forEach(遍历)</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">12</span>, <span class="number">65</span>, <span class="number">58</span>, <span class="number">39</span>, <span class="number">87</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">arr.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    sum += item</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h5><p>Array.from([array-like]) =&gt; {x, x, x}</p>
<h4 id="json变化："><a href="#json变化：" class="headerlink" title="json变化："></a>json变化：</h4><ol>
<li><p>简写：名字和值一样的，可以省略</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">let</span> b = <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> json = &#123;a, b&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>function可以不写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> json = &#123;</span><br><span class="line">    a: <span class="number">12</span>,</span><br><span class="line">    b: <span class="number">24</span>,</span><br><span class="line">    show1: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a + <span class="keyword">this</span>.b)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 可以直接写为</span></span><br><span class="line">    show() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a + <span class="keyword">this</span>.b)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="四、字符串"><a href="#四、字符串" class="headerlink" title="四、字符串"></a>四、字符串</h3><h4 id="字符串模板"><a href="#字符串模板" class="headerlink" title="字符串模板"></a>字符串模板</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> json = &#123;</span><br><span class="line">    name: <span class="string">'zhangsan'</span>,</span><br><span class="line">    age: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alert(<span class="string">'我叫'</span> + json.name + <span class="string">',今年'</span> + json.age + <span class="string">'岁'</span>)</span><br><span class="line">alert(<span class="string">'我叫$&#123;json.name&#125;,今年$&#123;json.age&#125;岁'</span>)</span><br><span class="line"><span class="comment">// 模板2</span></span><br><span class="line">alert(<span class="string">`ab</span></span><br><span class="line"><span class="string">cde</span></span><br><span class="line"><span class="string">f</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>

<h4 id="startsWith"><a href="#startsWith" class="headerlink" title="startsWith"></a>startsWith</h4><p>判断是否以…开始</p>
<h4 id="endsWith"><a href="#endsWith" class="headerlink" title="endsWith"></a>endsWith</h4><p>判断是否以…结尾</p>
<h3 id="五、面向对象"><a href="#五、面向对象" class="headerlink" title="五、面向对象"></a>五、面向对象</h3><p>箭头this、bind<br>统一标准化：class、constroctor；extend、super。写法上的变化。  </p>
<p>bind: 给一个函数定死一个this</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bind固定this指向</span></span><br><span class="line"><span class="built_in">document</span>.onclick = p.showName.bind(p) <span class="comment">// 相当于写一个函数括起来</span></span><br></pre></td></tr></table></figure>

<p>普通函数：根据调用的人，this经常变<br>箭头函数：根据所在环境，this恒定</p>
<p>编译：一个语言编程另一语言。<br>打包：多个文件打成压缩包，减少HTTP请求，提高性能。</p>
<h3 id="六、Promise"><a href="#六、Promise" class="headerlink" title="六、Promise"></a>六、Promise</h3><p>异步操作同步化。类似语法糖，将异步请求看上去同步化<br>作用：解决异步操作。  </p>
<p>同步：串行，简单、方便<br>异步：并发，性能高、体验好</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 异步</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'/banner_data'</span>,</span><br><span class="line">    success(data) &#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url: <span class="string">'/user_data'</span>,</span><br><span class="line">            success(data) &#123;</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    url: <span class="string">'/item_data'</span>,</span><br><span class="line">                    success(data) &#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;,</span><br><span class="line">                    error() &#123;</span><br><span class="line">                        alert(数据获取失败)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">            error() &#123;</span><br><span class="line">                alert(数据获取失败)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    error() &#123;</span><br><span class="line">        alert(<span class="string">'数据获取失败'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步</span></span><br><span class="line"><span class="keyword">let</span> banners = $.ajax(&#123;<span class="attr">url</span>: <span class="string">'/banner_data'</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> user = $.ajax(&#123;<span class="attr">url</span>: <span class="string">'/user_data'</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> item = $.ajax(&#123;<span class="attr">url</span>: <span class="string">'/item_data'</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>==用同步的方式写异步：==</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: <span class="string">'1.txt'</span>,</span><br><span class="line">        dataType: <span class="string">'json'</span>,</span><br><span class="line">        success(data) &#123;</span><br><span class="line">            reslove(json)</span><br><span class="line">        &#125;,</span><br><span class="line">        error(err) &#123;</span><br><span class="line">            reject(json)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">p.then(<span class="function"><span class="params">json</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(json)</span><br><span class="line">&#125;, err =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'err'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Promise.all()</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all([</span><br><span class="line">    p, p1, p2</span><br><span class="line">]).then()</span><br></pre></td></tr></table></figure>

<ol>
<li>Promise有用，解除异步操作</li>
<li>Promise有局限：带逻辑的异步操作较麻烦</li>
</ol>
<p>Promise.all(), 与：所有的都成功。<br>Promise.race(), 或：只要有一个完成。</p>
<h3 id="七、generator生成器"><a href="#七、generator生成器" class="headerlink" title="七、generator生成器"></a>七、generator生成器</h3><p>生成器函数：能暂停，通过==yield==暂停</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'aaa'</span>);</span><br><span class="line">    <span class="keyword">yield</span>;</span><br><span class="line">    alert(<span class="string">'bbb'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> gen = show();</span><br><span class="line"></span><br><span class="line">gen.next(); <span class="comment">// aaa</span></span><br><span class="line"></span><br><span class="line">gen.next(); <span class="comment">// bbb</span></span><br></pre></td></tr></table></figure>

<p>yield: 可以传参和返回值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'aaa'</span>);</span><br><span class="line">    <span class="keyword">let</span> a = <span class="keyword">yield</span>;</span><br><span class="line">    <span class="comment">// yield 55; //返回值</span></span><br><span class="line">    alert(<span class="string">'bbb'</span> + a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> gen = show();</span><br><span class="line">gen.next(); <span class="comment">// aaa</span></span><br><span class="line"><span class="comment">// let res1 = gen.next()</span></span><br><span class="line"><span class="comment">// console.log(res1) // &#123;value: 55, done: false&#125;</span></span><br><span class="line">gen.next(<span class="number">12</span>); <span class="comment">// 注意传参在这一块</span></span><br><span class="line"><span class="comment">// let res2 = gen.next()</span></span><br><span class="line"><span class="comment">// console.log(res2) // &#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="generator和promise配合"><a href="#generator和promise配合" class="headerlink" title="generator和promise配合"></a>generator和promise配合</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> data1 = yeild $.ajax(&#123;<span class="attr">url</span>: <span class="string">'1.txt'</span>, <span class="attr">dataType</span>: <span class="string">'json'</span>&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (data1.a + data1.b &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> data2 = <span class="keyword">yield</span> $.ajax(&#123;<span class="attr">url</span>: <span class="string">'2.txt'</span>, <span class="attr">dataType</span>: <span class="string">'json'</span>&#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> data3 = <span class="keyword">yield</span> $.ajax(&#123;<span class="attr">url</span>: <span class="string">'3.txt'</span>, <span class="attr">dataType</span>: <span class="string">'json'</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">runner(show)</span><br></pre></td></tr></table></figure>

<p>generator和promise配合需要一个外来runner辅助执行，会带来不统一、不标准、性能低。且generator函数不能写成箭头函数。</p>
<h3 id="八、async-await"><a href="#八、async-await" class="headerlink" title="八、async/await"></a>八、async/await</h3><p>和generator类似</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">async function show() &#123;</span><br><span class="line">    let data1 = await $.ajax(&#123;url: &apos;1.txt&apos;, dataType: &apos;json&apos;&#125;);</span><br><span class="line">    let data2 = await $.ajax(&#123;url: &apos;2.txt&apos;, dataType: &apos;json&apos;&#125;);</span><br><span class="line">    let data3 = await $.ajax(&#123;url: &apos;3.txt&apos;, dataType: &apos;json&apos;&#125;);</span><br><span class="line">&#125;</span><br><span class="line">show();</span><br></pre></td></tr></table></figure>

<p>格式用法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">let</span> 结果 = <span class="keyword">await</span> 异步操作-promise、generator、另一个<span class="keyword">async</span>函数</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/04/05/vue/Electron-vue跨平台桌面应用开发/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱程程">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/first.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小二、上酒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/05/vue/Electron-vue跨平台桌面应用开发/" itemprop="url">Electron-vue跨平台桌面应用开发</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-04-05T17:38:14+08:00">
                2022-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>github地址：<a href="https://github.com/electron/electron" target="_blank" rel="noopener">https://github.com/electron/electron</a><br>官网：<a href="https://electronjs.org" target="_blank" rel="noopener">https://electronjs.org</a></p>
<h2 id="基于Nodejs的主流桌面应用开发框架NW-js和Electron介绍"><a href="#基于Nodejs的主流桌面应用开发框架NW-js和Electron介绍" class="headerlink" title="基于Nodejs的主流桌面应用开发框架NW.js和Electron介绍"></a>基于Nodejs的主流桌面应用开发框架NW.js和Electron介绍</h2><p>NW.js和Electron都可以用前端的知识来开发桌面应用。<br>NW.js和Electron可以用Nodejs中几乎所有的模块。NW.js和Electron不仅可以把html写的web页面打包成跨平台可以安装到电脑上的软件，也可通过JavaScript访问操作系统原生的UI和Api</p>
<h2 id="Electron把html、css、JavaScript组成的程序构建为跨平台桌面应用程序的原理"><a href="#Electron把html、css、JavaScript组成的程序构建为跨平台桌面应用程序的原理" class="headerlink" title="Electron把html、css、JavaScript组成的程序构建为跨平台桌面应用程序的原理"></a>Electron把html、css、JavaScript组成的程序构建为跨平台桌面应用程序的原理</h2><p>通过将Chromium和Node.js合并到同一个运行时环境中，并将其打包为Mac、Windows和Linux系统下的应用来实现这一目的</p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ol>
<li>node.js</li>
<li>git</li>
</ol>
<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><ol>
<li>安装electron  npm install -g electron</li>
<li>创建项目  通过git克隆项目</li>
</ol>
<ul>
<li>cd到对应的项目里</li>
<li>克隆实例项目的仓库：git clone <a href="https://github.com/electron/electron-quick-start" target="_blank" rel="noopener">https://github.com/electron/electron-quick-start</a></li>
<li>进入这个仓库： cd electron-quick-start</li>
<li>安装依赖并运行 npm install &amp;&amp; npm start </li>
</ul>
<ol start="3">
<li>通过electron-forge 创建项目<br>electron-forge相当于electron的一个脚手架，可以让我们更方便的创建、运行、打包electron项目  </li>
</ol>
<ul>
<li>全局安装electron-forge  npm install -g electron-forge</li>
<li>创建项目 electron-forge init my-new-app<br>注意：这一步会默认安装模块，如果失败删掉node_modules，重新cd到项目里面运行 cnpm install</li>
<li>cd 项目</li>
<li>运行项目 npm start</li>
</ul>
<ol start="4">
<li>通过electron手动创建项目</li>
</ol>
<ul>
<li>新建一个文件夹（文件夹不能是中文）</li>
<li>新建一个index.html和一个main.js</li>
<li>npm init生成一个package.json</li>
</ul>
<h2 id="Electron-vue-cli3开发跨平台应用"><a href="#Electron-vue-cli3开发跨平台应用" class="headerlink" title="Electron + vue-cli3开发跨平台应用"></a>Electron + vue-cli3开发跨平台应用</h2><p>electron-vue和网上很多教程主要针对vue-cli2创建的项目，而我的项目是用vue-cli3创建的。<br>大概的流程：</p>
<h3 id="一、创建vue项目"><a href="#一、创建vue项目" class="headerlink" title="一、创建vue项目"></a>一、创建vue项目</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create electron-vue-demo</span><br></pre></td></tr></table></figure>

<h3 id="二、安装electron"><a href="#二、安装electron" class="headerlink" title="二、安装electron"></a>二、安装electron</h3><p>进入项目根目录，执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue add electron-builder</span><br></pre></td></tr></table></figure>

<p>安装完成后会自动在src目录下生成background.js并修改了package.json。<br>安装失败也可以手动的</p>
<h3 id="三、安装依赖包"><a href="#三、安装依赖包" class="headerlink" title="三、安装依赖包"></a>三、安装依赖包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p>如果安装过程中报错：Error: post install error, please remove node_modules before retry!可以忽略，不影响后续使用。</p>
<h3 id="四、编译并启动App"><a href="#四、编译并启动App" class="headerlink" title="四、编译并启动App"></a>四、编译并启动App</h3><p>执行以下命令，开始编译APP，并启动开发环境APP：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run electron:serve</span><br></pre></td></tr></table></figure>

<h3 id="五、打包成桌面应用程序"><a href="#五、打包成桌面应用程序" class="headerlink" title="五、打包成桌面应用程序"></a>五、打包成桌面应用程序</h3><p>首先在package.json中添加Electron的依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install electron --save-dev //添加依赖</span><br><span class="line"></span><br><span class="line">npm install electron-packager --save-dev //这个是打成exe文件的插件</span><br><span class="line"></span><br><span class="line">npm run electron:build //build工程</span><br></pre></td></tr></table></figure>

<p>最终在dist_electron目录下生成build后的产品。<br>exe执行文件在文件夹win-unpacked中（Windows系统）<br>32位环境下打包生成的是32位APP，在64位环境下打包生成的是64位APP</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/first.jpg" alt="朱程程">
            
              <p class="site-author-name" itemprop="name">朱程程</p>
              <p class="site-description motion-element" itemprop="description">人生当苦无妨，良人当归即好</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">68</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/devil-chengcheng" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">朱程程</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
